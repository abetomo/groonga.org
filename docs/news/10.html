
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>News - 10 series &#8212; Groonga v14.0.9 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=ca3fa23a"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-7532323-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-7532323-1');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-7532323-1');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'news/10';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.3';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://groonga.org/docs/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'english';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

   

<a class="navbar-brand logo" href="https://groonga.org/">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/groonga.png" class="logo__image only-light" alt="Groonga v14.0.9 documentation - Home"/>
    <script>document.write(`<img src="../_static/groonga.png" class="logo__image only-dark" alt="Groonga v14.0.9 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/groonga/groonga" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/groonga" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="/blog" title="Blog" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-blog fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Blog</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/groonga/groonga" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/groonga" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="/blog" title="Blog" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-blog fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Blog</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">News - 10 series</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="news-10-series">
<h1>News - 10 series<a class="headerlink" href="#news-10-series" title="Link to this heading">#</a></h1>
<section id="release-10-1-1-2021-01-25">
<span id="release-10-1-1"></span><h2>Release 10.1.1 - 2021-01-25<a class="headerlink" href="#release-10-1-1-2021-01-25" title="Link to this heading">#</a></h2>
<section id="improvements">
<h3>Improvements<a class="headerlink" href="#improvements" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for outputting UInt64 value in Apache Arrow format.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for outputting a number of hits in Apache Arrow format as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">metadata</span> <span class="o">--</span>
<span class="n">GROONGA</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">hits</span><span class="p">:</span> <span class="mi">10</span>
</pre></div>
</div>
</li>
<li><p>[<a class="reference internal" href="../reference/functions/query.html"><span class="doc">query</span></a>] Added support for optimization of “order by estimated size”.</p>
<ul class="simple">
<li><p>Normally, we can search at high speed when we first execute a condition which number of hits is a little.</p>
<ul>
<li><p>The “B (There are few) &amp;&amp; A (There are many)” faster than “A (There are many) &amp;&amp; B (There are few)”.</p></li>
</ul>
</li>
<li><p>This is a known optimization. However we need reorder conditions by ourselves.</p></li>
<li><p>Groonga executes this reorder automatically by using optimization of “order by estimated size”.</p></li>
<li><p>This optimization is valid by <code class="docutils literal notranslate"><span class="pre">GRN_ORDER_BY_ESTIMATED_SIZE_ENABLE=yes</span></code>.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/functions/between.html"><span class="doc">between</span></a>] Improved performance by the following improvements.</p>
<ul class="simple">
<li><p>Improved the accuracy of a decision whether the <code class="docutils literal notranslate"><span class="pre">between()</span></code> use sequential search or not.</p></li>
<li><p>Improved that we set a result of <code class="docutils literal notranslate"><span class="pre">between()</span></code> into a result set in bulk.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved performance for a prefix search.</p>
<ul>
<li><p>For example, the performance of the following prefix search by using “*” improved.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Memos</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span>
<span class="n">table_create</span> <span class="n">Contents</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span>   <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="n">column_create</span> <span class="n">Contents</span> <span class="n">entries_key_index</span> <span class="n">COLUMN_INDEX</span> <span class="n">Memos</span> <span class="n">_key</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;(groonga) Start to try!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;(mroonga) Installed&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;(groonga) Upgraded!&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> \
  <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">_key</span> \
  <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">(groonga</span><span class="se">\\</span><span class="s1">)*&#39;</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/tokenizers.html"><span class="doc">Tokenizers</span></a>][TokenMecab] Improved performance for parallel construction fo token column. [GitHub#1158][Patched by naoa]</p></li>
</ul>
</section>
<section id="fixes">
<h3>Fixes<a class="headerlink" href="#fixes" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/functions/sub_filter.html"><span class="doc">sub_filter</span></a>] Fixed a bug that <code class="docutils literal notranslate"><span class="pre">sub_filter</span></code> doesn’t work in <code class="docutils literal notranslate"><span class="pre">slices[].filter</span></code>.</p>
<ul>
<li><p>For example, the result of <code class="docutils literal notranslate"><span class="pre">sub_filter</span></code> was 0 records by the following query by this bug.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Users</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">Users</span> <span class="n">age</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt8</span>

<span class="n">table_create</span> <span class="n">Memos</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">user</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Users</span>
<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>   <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">29</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>   <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;bye&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>   <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;yay&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> \
  <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span> \
  <span class="o">--</span><span class="n">slices</span><span class="p">[</span><span class="n">adult</span><span class="p">]</span><span class="o">.</span><span class="n">filter</span> <span class="s1">&#39;_id &gt; 1 &amp;&amp; sub_filter(user, &quot;age &gt;= 18&quot;)&#39;</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Fixed a bug that it is possible that we can’t add data and Groonga crash when we repeat much addition of data and deletion of data against a hash table.</p></li>
</ul>
</section>
<section id="thanks">
<h3>Thanks<a class="headerlink" href="#thanks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>naoa</p></li>
</ul>
</section>
</section>
<section id="release-10-1-0-2020-12-29">
<span id="release-10-1-0"></span><h2>Release 10.1.0 - 2020-12-29<a class="headerlink" href="#release-10-1-0-2020-12-29" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Improvements<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/functions/highlight_html.html"><span class="doc">highlight_html</span></a>] Added support for removing leading full width spaces from highlight target. [PGroonga#GitHub#155][Reported by Hung Nguyen V]</p>
<ul>
<li><p>Until now, leading full width spaces had also included in the target of highlight as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">body</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">document_index</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">body</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga　高速！&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> <span class="o">--</span><span class="n">output_columns</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">body</span> <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;高速&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;highlight_html(body)&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;highlight_html&quot;</span><span class="p">,</span>
          <span class="n">null</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;Groonga&lt;span class=</span><span class="se">\&quot;</span><span class="s2">keyword</span><span class="se">\&quot;</span><span class="s2">&gt;　高速&lt;/span&gt;！&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>However, this is needless as the target of highlight.
Therefore, in this release, <code class="docutils literal notranslate"><span class="pre">highlight_html()</span></code> removes leading full width spaces.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/status.html"><span class="doc">status</span></a>] Added a new item <code class="docutils literal notranslate"><span class="pre">features</span></code>.</p>
<ul>
<li><p>We can display which Groonga’s features are enabled as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">status</span> <span class="o">--</span><span class="n">output_pretty</span> <span class="n">yes</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">{</span>
    <span class="s2">&quot;alloc_count&quot;</span><span class="p">:</span> <span class="mi">361</span><span class="p">,</span>
    <span class="s2">&quot;starttime&quot;</span><span class="p">:</span> <span class="mi">1608087311</span><span class="p">,</span>
    <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">1608087311</span><span class="p">,</span>
    <span class="s2">&quot;uptime&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;10.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n_queries&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;cache_hit_rate&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;command_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;default_command_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;max_command_version&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;nfkc&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;mecab&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;message_pack&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;mruby&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;onigmo&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;zlib&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;lz4&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;zstandard&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;kqueue&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;epoll&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;poll&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;rapidjson&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;apache_arrow&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;xxhash&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/status.html"><span class="doc">status</span></a>] Added a new item <code class="docutils literal notranslate"><span class="pre">apache_arrow</span></code>.</p>
<ul class="simple">
<li><p>We can display Apache Arrow version that Groonga use as below.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1608088628.440753</span><span class="p">,</span>
    <span class="mf">0.0006628036499023438</span>
  <span class="p">],</span>
  <span class="p">{</span>
    <span class="s2">&quot;alloc_count&quot;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span>
    <span class="s2">&quot;starttime&quot;</span><span class="p">:</span> <span class="mi">1608088617</span><span class="p">,</span>
    <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">1608088617</span><span class="p">,</span>
    <span class="s2">&quot;uptime&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.9-39-g5a4c6f3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n_queries&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;cache_hit_rate&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;command_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;default_command_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;max_command_version&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;nfkc&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;mecab&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;message_pack&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;mruby&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;onigmo&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;zlib&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;lz4&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;zstandard&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;kqueue&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;epoll&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;poll&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;rapidjson&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;apache_arrow&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;xxhash&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">},</span>
    <span class="s2">&quot;apache_arrow&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;version_major&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;version_minor&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;version_patch&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0.0&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This item only display when Apache Arrow is valid in Groonga.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/window_function.html"><span class="doc">Window function</span></a>] Added support for processing all tables at once even if target tables straddle a shard. (experimental)</p>
<ul>
<li><p>If the target tables straddle a shard, the window function had processed each shard until now.</p>
<ul>
<li><p>Therefore, if we used multiple group keys in windows functions, the value of the group keys from the second had to be one kind of value.</p></li>
<li><p>However, we can use multiple kind of values for it as below by this improvement.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plugin_register</span> <span class="n">sharding</span>
<span class="n">plugin_register</span> <span class="n">functions</span><span class="o">/</span><span class="n">time</span>

<span class="n">table_create</span> <span class="n">Logs_20170315</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Logs_20170315</span> <span class="n">timestamp</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Time</span>
<span class="n">column_create</span> <span class="n">Logs_20170315</span> <span class="n">price</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">column_create</span> <span class="n">Logs_20170315</span> <span class="n">item</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Logs_20170316</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Logs_20170316</span> <span class="n">timestamp</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Time</span>
<span class="n">column_create</span> <span class="n">Logs_20170316</span> <span class="n">price</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">column_create</span> <span class="n">Logs_20170316</span> <span class="n">item</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Logs_20170317</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Logs_20170317</span> <span class="n">timestamp</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Time</span>
<span class="n">column_create</span> <span class="n">Logs_20170317</span> <span class="n">price</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">column_create</span> <span class="n">Logs_20170317</span> <span class="n">item</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Logs_20170315</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/15 10:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/15 11:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">900</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/15 12:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/15 13:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Logs_20170316</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/16 10:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">530</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/16 11:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">520</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/16 12:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">110</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/16 13:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">410</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/16 14:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">710</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Logs_20170317</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/17 10:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">800</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/17 11:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">400</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/17 12:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">500</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2017/03/17 13:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span>  <span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">table_create</span> <span class="n">Times</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">Time</span>
<span class="n">column_create</span> <span class="n">Times</span> <span class="n">logs_20170315</span> <span class="n">COLUMN_INDEX</span> <span class="n">Logs_20170315</span> <span class="n">timestamp</span>
<span class="n">column_create</span> <span class="n">Times</span> <span class="n">logs_20170316</span> <span class="n">COLUMN_INDEX</span> <span class="n">Logs_20170316</span> <span class="n">timestamp</span>
<span class="n">column_create</span> <span class="n">Times</span> <span class="n">logs_20170317</span> <span class="n">COLUMN_INDEX</span> <span class="n">Logs_20170317</span> <span class="n">timestamp</span>

<span class="n">logical_range_filter</span> <span class="n">Logs</span> \
  <span class="o">--</span><span class="n">shard_key</span> <span class="n">timestamp</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;price &gt;= 300&#39;</span> \
  <span class="o">--</span><span class="n">limit</span> <span class="o">-</span><span class="mi">1</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_timestamp</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">filtered</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_timestamp</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">Time</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_timestamp</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_timestamp</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;timestamp - 39600000000&#39;</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_day</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">filtered</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_day</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">Time</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_day</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">offsetted_day</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;time_classify_day(offsetted_timestamp)&#39;</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">n_records_per_day_and_item</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">filtered</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">n_records_per_day_and_item</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">UInt32</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">n_records_per_day_and_item</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">n_records_per_day_and_item</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;window_count()&#39;</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">n_records_per_day_and_item</span><span class="p">]</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">group_keys</span> <span class="s1">&#39;offsetted_day,item&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id,time_format_iso8601(offsetted_day),item,n_records_per_day_and_item&quot;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;UInt32&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;time_format_iso8601&quot;</span><span class="p">,</span>
        <span class="n">null</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;item&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ShortText&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;n_records_per_day_and_item&quot;</span><span class="p">,</span>
        <span class="s2">&quot;UInt32&quot;</span>
      <span class="p">]</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-14T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;A&quot;</span><span class="p">,</span>
      <span class="mi">1</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-15T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;A&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-15T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;B&quot;</span><span class="p">,</span>
      <span class="mi">1</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-15T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;A&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-16T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;B&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-16T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;A&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-16T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;B&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-16T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;A&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-17T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;B&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-17T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;B&quot;</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="p">[</span>
      <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;2017-03-17T00:00:00.000000+09:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;A&quot;</span><span class="p">,</span>
      <span class="mi">1</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>This feature requires Apache Arrow 3.0.0 that is not released yet.</p></li>
</ul>
</li>
<li><p>Added support for sequential search against reference column.</p>
<ul>
<li><p>This feature is only used if an index search will match many records and the current result set is enough small.</p>
<ul class="simple">
<li><p>Because the sequential search is faster than the index search in the above case.</p></li>
</ul>
</li>
<li><p>It is invalid by default.</p></li>
<li><p>It is valid if we set <code class="docutils literal notranslate"><span class="pre">GRN_II_SELECT_TOO_MANY_INDEX_MATCH_RATIO_REFERENCE</span></code> environment variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GRN_II_SELECT_TOO_MANY_INDEX_MATCH_RATIO_REFERENCE</span></code> environment variable is a threshold to switch the sequential search from the index search.</p>
<ul>
<li><p>For example, if we set <code class="docutils literal notranslate"><span class="pre">GRN_II_SELECT_TOO_MANY_INDEX_MATCH_RATIO_REFERENCE=0.7</span></code> as below, if the number of records for the result set less than 70 % of total records, a search is executed by a sequential search.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export GRN_II_SELECT_TOO_MANY_INDEX_MATCH_RATIO_REFERENCE=0.7

table_create Tags TABLE_HASH_KEY ShortText
table_create Memos TABLE_HASH_KEY ShortText
column_create Memos tag COLUMN_SCALAR Tags

load --table Memos
[
{&quot;_key&quot;: &quot;Rroonga is fast!&quot;, &quot;tag&quot;: &quot;Rroonga&quot;},
{&quot;_key&quot;: &quot;Groonga is fast!&quot;, &quot;tag&quot;: &quot;Groonga&quot;},
{&quot;_key&quot;: &quot;Mroonga is fast!&quot;, &quot;tag&quot;: &quot;Mroonga&quot;},
{&quot;_key&quot;: &quot;Groonga sticker!&quot;, &quot;tag&quot;: &quot;Groonga&quot;},
{&quot;_key&quot;: &quot;Groonga is good!&quot;, &quot;tag&quot;: &quot;Groonga&quot;}
]

column_create Tags memos_tag COLUMN_INDEX Memos tag

select Memos --query &#39;_id:&gt;=3 tag:@Groonga&#39; --output_columns _id,_score,_key,tag
[
  [
    0,
    0.0,
    0.0
  ],
  [
    [
      [
        2
      ],
      [
        [
          &quot;_id&quot;,
          &quot;UInt32&quot;
        ],
        [
          &quot;_score&quot;,
          &quot;Int32&quot;
        ],
        [
          &quot;_key&quot;,
          &quot;ShortText&quot;
        ],
        [
          &quot;tag&quot;,
          &quot;Tags&quot;
        ]
      ],
      [
        4,
        2,
        &quot;Groonga sticker!&quot;,
        &quot;Groonga&quot;
      ],
      [
        5,
        2,
        &quot;Groonga is good!&quot;,
        &quot;Groonga&quot;
      ]
    ]
  ]
]
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li><p>[tokenizers] Added support for the token column into <code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorTFIDF</span></code> and <code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorBM25</span></code>.</p>
<ul>
<li><p>If there is the token column that has the same source as the index column, these tokenizer use the token id of the token column.</p>
<ul class="simple">
<li><p>The token column has already had data that has already finished tokenize.</p></li>
<li><p>Therefore, these tokenizer are improved performance by using a token column.</p></li>
</ul>
</li>
<li><p>For example, we can use this feature by making a token column named <code class="docutils literal notranslate"><span class="pre">content_tokens</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Memos</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;a b c a&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;c b c&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;b b a&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;a c c&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">table_create</span> <span class="n">Tokens</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerNFKC121</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenNgram</span>
<span class="n">column_create</span> <span class="n">Tokens</span> <span class="n">memos_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Memos</span> <span class="n">content</span>

<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">content_tokens</span> <span class="n">COLUMN_VECTOR</span> <span class="n">Tokens</span> <span class="n">content</span>

<span class="n">table_create</span> <span class="n">DocumentVectorBM25</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">Tokens</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> \
    <span class="s1">&#39;TokenDocumentVectorBM25(&quot;index_column&quot;, &quot;memos_content&quot;, </span><span class="se">\</span>
<span class="s1">                             &quot;df_column&quot;, &quot;df&quot;)&#39;</span>
<span class="n">column_create</span> <span class="n">DocumentVectorBM25</span> <span class="n">df</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>

<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">content_feature</span> <span class="n">COLUMN_VECTOR</span><span class="o">|</span><span class="n">WITH_WEIGHT</span><span class="o">|</span><span class="n">WEIGHT_FLOAT32</span> \
  <span class="n">DocumentVectorBM25</span> <span class="n">content</span>

<span class="n">select</span> <span class="n">Memos</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">5</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;content&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Text&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;content_feature&quot;</span><span class="p">,</span>
          <span class="s2">&quot;DocumentVectorBM25&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;content_tokens&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Tokens&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;a b c a&quot;</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mf">0.5095787</span><span class="p">,</span>
          <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">0.6084117</span><span class="p">,</span>
          <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mf">0.6084117</span>
        <span class="p">},</span>
        <span class="p">[</span>
          <span class="s2">&quot;a&quot;</span><span class="p">,</span>
          <span class="s2">&quot;b&quot;</span><span class="p">,</span>
          <span class="s2">&quot;c&quot;</span><span class="p">,</span>
          <span class="s2">&quot;a&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;c b c&quot;</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mf">0.8342565</span><span class="p">,</span>
          <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">0.5513765</span>
        <span class="p">},</span>
        <span class="p">[</span>
          <span class="s2">&quot;c&quot;</span><span class="p">,</span>
          <span class="s2">&quot;b&quot;</span><span class="p">,</span>
          <span class="s2">&quot;c&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;b b a&quot;</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">0.9430448</span><span class="p">,</span>
          <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mf">0.3326656</span>
        <span class="p">},</span>
        <span class="p">[</span>
          <span class="s2">&quot;b&quot;</span><span class="p">,</span>
          <span class="s2">&quot;b&quot;</span><span class="p">,</span>
          <span class="s2">&quot;a&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;a c c&quot;</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mf">0.3326656</span><span class="p">,</span>
          <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mf">0.9430448</span>
        <span class="p">},</span>
        <span class="p">[</span>
          <span class="s2">&quot;a&quot;</span><span class="p">,</span>
          <span class="s2">&quot;c&quot;</span><span class="p">,</span>
          <span class="s2">&quot;c&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;a&quot;</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mf">1.0</span>
        <span class="p">},</span>
        <span class="p">[</span>
          <span class="s2">&quot;a&quot;</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorTFIDF</span></code> and <code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorBM25</span></code> give a weight against each tokens.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorTFIDF</span></code> calculate a weight for token by using TF-IDF.</p>
<blockquote>
<div><ul class="simple">
<li><p>Please refer to <a class="reference external" href="https://radimrehurek.com/gensim/models/tfidfmodel.html">https://radimrehurek.com/gensim/models/tfidfmodel.html</a> about TF-IDF.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorBM25</span></code> calculate a weight for token by using Okapi BM25.</p>
<blockquote>
<div><ul class="simple">
<li><p>Please refer to <a class="reference external" href="https://en.wikipedia.org/wiki/Okapi_BM25">https://en.wikipedia.org/wiki/Okapi_BM25</a> about Okapi BM25.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Improved performance when below case.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(column</span> <span class="pre">&#64;</span> <span class="pre">&quot;value&quot;)</span> <span class="pre">&amp;&amp;</span> <span class="pre">(column</span> <span class="pre">&#64;</span> <span class="pre">&quot;value&quot;)</span></code></p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../install/ubuntu.html"><span class="doc">Ubuntu</span></a>] Added support for Ubuntu 20.10 (Groovy Gorilla).</p></li>
<li><p>[<a class="reference internal" href="../install/debian.html"><span class="doc">Debian GNU/Linux</span></a>] Dropped stretch support.</p>
<ul class="simple">
<li><p>It reached EOL.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../install/centos.html"><span class="doc">CentOS</span></a>] Dropped CentOS 6.</p>
<ul class="simple">
<li><p>It reached EOL.</p></li>
</ul>
</li>
<li><p>[httpd] Updated bundled nginx to 1.19.6.</p></li>
</ul>
</section>
<section id="id2">
<h3>Fixes<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul>
<li><p>Fixed a bug that Groonga crash when we use multiple keys drilldown and use multiple accessor as below. [GitHub#1153][Patched by naoa]</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Tags</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Memos</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">tags</span> <span class="n">COLUMN_VECTOR</span> <span class="n">Tags</span>
<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">year</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Int32</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is fast!&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;full-text-search&quot;</span><span class="p">],</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2019</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Mroonga is fast!&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mysql&quot;</span><span class="p">,</span> <span class="s2">&quot;full-text-search&quot;</span><span class="p">],</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2019</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga sticker!&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;full-text-search&quot;</span><span class="p">,</span> <span class="s2">&quot;sticker&quot;</span><span class="p">],</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2020</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Rroonga is fast!&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;full-text-search&quot;</span><span class="p">,</span> <span class="s2">&quot;ruby&quot;</span><span class="p">],</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2020</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is good!&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;full-text-search&quot;</span><span class="p">],</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2020</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Memos</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;_id &gt; 0&#39;</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tags</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span> <span class="s1">&#39;tags,year &gt;= 2020&#39;</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tags</span><span class="p">]</span><span class="o">.</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">_key</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">_nsubrecs</span>

<span class="n">select</span> <span class="n">Memos</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;_id &gt; 0&#39;</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tags</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span> <span class="s1">&#39;tags,year &gt;= 2020&#39;</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tags</span><span class="p">]</span><span class="o">.</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">_nsubrecs</span>
</pre></div>
</div>
</li>
<li><p>Fixed a bug that the near phrase search did not match when the same phrase occurs multiple times as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenNgram</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerNFKC121</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">entries_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">content</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;a x a x b x x&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;a x x b x&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">content</span> \
  <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;*NP2&quot;a b&quot;&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;_score, content&#39;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id3">
<h3>Thanks<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Hung Nguyen V</p></li>
<li><p>naoa</p></li>
<li><p>timgates42 [Provided the patch at GitHub#1155]</p></li>
</ul>
</section>
</section>
<section id="release-10-0-9-2020-12-01">
<span id="release-10-0-9"></span><h2>Release 10.0.9 - 2020-12-01<a class="headerlink" href="#release-10-0-9-2020-12-01" title="Link to this heading">#</a></h2>
<section id="id4">
<h3>Improvements<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<ul>
<li><p>Improved performance when we specified <code class="docutils literal notranslate"><span class="pre">-1</span></code> to <code class="docutils literal notranslate"><span class="pre">limit</span></code>.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/reference_acquire.html"><span class="doc">reference_acquire</span></a>] Added a new option <code class="docutils literal notranslate"><span class="pre">--auto_release_count</span></code>.</p>
<ul>
<li><p>Groonga reduces a reference count automatically when a request reaching the number of value that is specified in <code class="docutils literal notranslate"><span class="pre">--auto_release_count</span></code>.</p></li>
<li><p>For example, the acquired reference of <code class="docutils literal notranslate"><span class="pre">Users</span></code> is released automatically after the second <code class="docutils literal notranslate"><span class="pre">status</span></code> is processed as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reference_acquire</span> <span class="o">--</span><span class="n">target_name</span> <span class="n">Users</span> <span class="o">--</span><span class="n">auto_release_count</span> <span class="mi">2</span>
<span class="n">status</span> <span class="c1"># Users is still referred.</span>
<span class="n">status</span> <span class="c1"># Users&#39; reference is released after this command is processed.</span>
</pre></div>
</div>
</li>
<li><p>We can prevent a leak of the release of acquired reference by this option.</p></li>
</ul>
</li>
<li><p>Modify behavior when Groonga evaluated empty <code class="docutils literal notranslate"><span class="pre">vector</span></code> and <code class="docutils literal notranslate"><span class="pre">uvector</span></code>.</p>
<ul class="simple">
<li><p>Empty <code class="docutils literal notranslate"><span class="pre">vector</span></code> and <code class="docutils literal notranslate"><span class="pre">uvector</span></code> are evaluated to <code class="docutils literal notranslate"><span class="pre">false</span></code> in command version 3.</p>
<ul>
<li><p>This behavior is valid for only command version 3.</p></li>
<li><p>Note that the different behavior until now.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/normalizers.html"><span class="doc">Normalizers</span></a>] Added a new Normalizer <code class="docutils literal notranslate"><span class="pre">NormalizerNFKC130</span></code> based on Unicode NFKC (Normalization Form Compatibility Composition) for Unicode 13.0.</p></li>
<li><p>[<a class="reference internal" href="../reference/token_filters.html"><span class="doc">Token filters</span></a>] Added a new TokenFilter <code class="docutils literal notranslate"><span class="pre">TokenFilterNFKC130</span></code> based on Unicode NFKC (Normalization Form Compatibility Composition) for Unicode 13.0.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved performance for <code class="docutils literal notranslate"><span class="pre">&quot;_score</span> <span class="pre">=</span> <span class="pre">column</span> <span class="pre">-</span> <span class="pre">X&quot;</span></code>.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/reference_acquire.html"><span class="doc">reference_acquire</span></a>] Improved that <code class="docutils literal notranslate"><span class="pre">--reference_acquire</span></code> doesn’t get unnecessary reference of index column when we specify the <code class="docutils literal notranslate"><span class="pre">--recursive</span> <span class="pre">dependent</span></code> option.</p>
<ul class="simple">
<li><p>From this release, the targets of <code class="docutils literal notranslate"><span class="pre">--recursive</span> <span class="pre">dependent</span></code> are only the target table’s key  and the index column that is set to data column.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Add support for ordered near phrase search.</p>
<ul>
<li><p>Until now, the near phrase search have only looked for records that the distance of between specified phrases near.</p></li>
<li><p>This feature look for satisfy the following conditions records.</p>
<ul class="simple">
<li><p>If the distance of between specified phrases is near.</p></li>
<li><p>If the specified phrases are in line with specified order.</p></li>
</ul>
</li>
<li><p>This feature use <code class="docutils literal notranslate"><span class="pre">*ONP</span></code> as an operator. (Note that the operator isn’t <code class="docutils literal notranslate"><span class="pre">*NP</span></code>.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span></code> is handled as itself in the query syntax. Note that it isn’t a special character in the query syntax.</p></li>
<li><p>If we use script syntax, this feature use as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="s1">&#39;TokenNgram(&quot;unify_alphabet&quot;, false, </span><span class="se">\</span>
<span class="s1">                                  &quot;unify_digit&quot;, false)&#39;</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerNFKC121</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">entries_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">content</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;abcXYZdef&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;abebcdXYZdef&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;abcdef&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;defXYZabc&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;XYZabc&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;abc123456789def&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;abc12345678def&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;abc1de2def&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;content *ONP &quot;abc def&quot;&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;_score, content&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">4</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_score&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Int32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;content&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Text&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abcXYZdef&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abcdef&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abc12345678def&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abc1de2def&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>If we use query syntax, this feature use as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Entries</span> <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;content:*ONP &quot;abc def&quot;&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;_score, content&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">4</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_score&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Int32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;content&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Text&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abcXYZdef&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abcdef&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abc12345678def&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;abc1de2def&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[httpd] Updated bundled nginx to 1.19.5.</p></li>
</ul>
</section>
<section id="id5">
<h3>Fixes<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>[<a class="reference internal" href="../reference/executables/groonga-server-http.html"><span class="doc">Groonga HTTP server</span></a>] Fixed that Groonga HTTP server finished without waiting all woker threads finished completely.</p>
<ul>
<li><p>Until now, Groonga HTTP server had started the process of finish after worker threads finished itself process.
However, worker threads may not finish completely at this timing. Therefore, Groonga HTTP server may crashed according to timing. Because Groonga HTTP server may free area of memory that worker threads are using them yet.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="release-10-0-8-2020-10-29">
<span id="release-10-0-8"></span><h2>Release 10.0.8 - 2020-10-29<a class="headerlink" href="#release-10-0-8-2020-10-29" title="Link to this heading">#</a></h2>
<section id="id6">
<h3>Improvements<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for large drilldown keys.</p>
<ul>
<li><p>The maximum on the key size of Groonga’s tables are 4KiB.
However, if we specify multiple keys in drilldown, the size of drilldown keys may be larger than 4KiB.</p>
<ul class="simple">
<li><p>For example, if the total size for <code class="docutils literal notranslate"><span class="pre">tag</span></code> key and <code class="docutils literal notranslate"><span class="pre">n_like</span></code> key is lager than 4KiB in the following case,
the drilldown had failed.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Entries</span> \
  <span class="o">--</span><span class="n">limit</span> <span class="o">-</span><span class="mi">1</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="n">tag</span><span class="p">,</span><span class="n">n_likes</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">n_likes</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span> <span class="n">tag</span><span class="p">,</span><span class="n">n_likes</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">n_likes</span><span class="p">]</span><span class="o">.</span><span class="n">output_columns</span> <span class="n">_value</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span><span class="n">_value</span><span class="o">.</span><span class="n">n_likes</span><span class="p">,</span><span class="n">_nsubrecs</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Because the drilldown packes specifying all keys for drilldown. So, if each the size of drilldown key is large,
the size of the packed drilldown keys is larger than 4KiB.</p></li>
</ul>
</li>
<li><p>This feature requires <a class="reference external" href="https://github.com/Cyan4973/xxHash">xxHash</a> .</p>
<ul class="simple">
<li><p>However, if we install Groonga from package, we can use this feature without doing anything special.
Because Groonga’s package already include <a class="reference external" href="https://github.com/Cyan4973/xxHash">xxHash</a> .</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for handling as the same dynamic column even if columns refer to different tables.</p>
<ul>
<li><p>We can’t have handled the same dynamic column if columns refer to different tables until now.
Because the type of columns is different.</p></li>
<li><p>However, from this version, we can handle the same dynamic column even if columns refer to different tables by casting to built-in types as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Store_A</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="n">table_create</span> <span class="n">Store_B</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Customers</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">Int32</span>
<span class="n">column_create</span> <span class="n">Customers</span> <span class="n">customers_A</span> <span class="n">COLUMN_VECTOR</span> <span class="n">Store_A</span>
<span class="n">column_create</span> <span class="n">Customers</span> <span class="n">customers_B</span> <span class="n">COLUMN_VECTOR</span> <span class="n">Store_B</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Customers</span>
<span class="p">[</span>
  <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">1604020694</span><span class="p">,</span> <span class="s2">&quot;customers_A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
  <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">1602724694</span><span class="p">,</span> <span class="s2">&quot;customers_B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">]},</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Customers</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;_key == 1604020694&#39;</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">customers</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">output</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">customers</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_VECTOR</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">customers</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">customers</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;customers_A&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;_key, customers&#39;</span>
</pre></div>
</div>
</li>
<li><p>We have needed to set <code class="docutils literal notranslate"><span class="pre">Store_A</span></code> or <code class="docutils literal notranslate"><span class="pre">Store_B</span></code> in the <code class="docutils literal notranslate"><span class="pre">type</span></code> of <code class="docutils literal notranslate"><span class="pre">customers</span></code> column until now.</p></li>
<li><p>The type of <code class="docutils literal notranslate"><span class="pre">customers_A</span></code> column cast to <code class="docutils literal notranslate"><span class="pre">ShortText</span></code> in the above example.</p></li>
<li><p>By this, we can also set the value of <code class="docutils literal notranslate"><span class="pre">customers_B</span></code> in the value of <code class="docutils literal notranslate"><span class="pre">customers</span></code> column.
Because both the key of <code class="docutils literal notranslate"><span class="pre">customers_A</span></code> and <code class="docutils literal notranslate"><span class="pre">customers_B</span></code> are <code class="docutils literal notranslate"><span class="pre">ShortText</span></code> type.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved performance when the number of records for search result are huge.</p>
<ul class="simple">
<li><p>This optimization works when below cases.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'column</span> <span class="pre">&lt;=</span> <span class="pre">&quot;value&quot;'</span></code> or <code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'column</span> <span class="pre">&gt;=</span> <span class="pre">&quot;value&quot;'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'column</span> <span class="pre">==</span> <span class="pre">&quot;value&quot;'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'between(...)'</span></code> or <code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'between(_key,</span> <span class="pre">...)'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'sub_filter(reference_column,</span> <span class="pre">...)'</span></code></p></li>
<li><p>Comparing against <code class="docutils literal notranslate"><span class="pre">_key</span></code> such as <code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'_key</span> <span class="pre">&gt;</span> <span class="pre">&quot;value&quot;'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">'geo_in_circle(...)'</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>Updated bundled LZ4 to 1.9.2 from 1.8.2.</p></li>
<li><p>Added support xxHash 0.8</p></li>
<li><p>[httpd] Updated bundled nginx to 1.19.4.</p></li>
</ul>
</section>
<section id="id8">
<h3>Fixes<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fixed the following bugs related the browser based administration tool. [GitHub#1139][Reported by sutamin]</p>
<ul>
<li><p>The problem that Groonga’s logo had not been displayed.</p></li>
<li><p>The problem that the throughput chart had not been displayed on the index page for Japanese.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/functions/between.html"><span class="doc">between</span></a>] Fixed a bug that <code class="docutils literal notranslate"><span class="pre">between(_key,</span> <span class="pre">...)</span></code> is always evaluated by sequential search.</p></li>
</ul>
</section>
<section id="id9">
<h3>Thanks<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>sutamin</p></li>
</ul>
</section>
</section>
<section id="release-10-0-7-2020-09-29">
<span id="release-10-0-7"></span><h2>Release 10.0.7 - 2020-09-29<a class="headerlink" href="#release-10-0-7-2020-09-29" title="Link to this heading">#</a></h2>
<section id="id10">
<h3>Improvements<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>[highlight], [<a class="reference internal" href="../reference/functions/highlight_full.html"><span class="doc">highlight_full</span></a>] Added support for normalizer options.</p></li>
<li><p>[<a class="reference internal" href="../reference/command/return_code.html"><span class="doc">Return code</span></a>] Added a new return code <code class="docutils literal notranslate"><span class="pre">GRN_CONNECTION_RESET</span></code> for resetting connection.</p>
<ul>
<li><p>it is returned when an existing connection was forcibly close by the remote host.</p></li>
</ul>
</li>
<li><p>Dropped Ubuntu 19.10 (Eoan Ermine).</p>
<ul>
<li><p>Because this version has been EOL.</p></li>
</ul>
</li>
<li><p>[httpd] Updated bundled nginx to 1.19.2.</p></li>
<li><p>[<a class="reference internal" href="../reference/executables/grndb.html"><span class="doc">grndb</span></a>] Added support for detecting duplicate keys.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grndb</span> <span class="pre">check</span></code> is also able to detect duplicate keys since this release.</p></li>
<li><p>This check valid except a table of <code class="docutils literal notranslate"><span class="pre">TABLE_NO_KEY</span></code>.</p></li>
<li><p>If the table that was detected duplicate keys by <code class="docutils literal notranslate"><span class="pre">grndb</span> <span class="pre">check</span></code> has only index columns, we can recover by <code class="docutils literal notranslate"><span class="pre">grndb</span> <span class="pre">recover</span></code>.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/table_create.html"><span class="doc">table_create</span></a>], [<a class="reference internal" href="../reference/commands/column_create.html"><span class="doc">column_create</span></a>] Added a new option <code class="docutils literal notranslate"><span class="pre">--path</span></code></p>
<ul>
<li><p>We can store specified a table or a column to any path using this option.</p></li>
<li><p>This option is useful if we want to store a table or a column that
we often use to fast storage (e.g. SSD) and store them that we don’t often
use to slow storage (e.g. HDD).</p></li>
<li><p>We can specify both relative path and absolute path in this option.</p>
<ul>
<li><p>If we specify relative path in this option, the path is resolved the path of <code class="docutils literal notranslate"><span class="pre">groonga</span></code> process as the origin.</p></li>
</ul>
</li>
<li><p>However, if we specify <code class="docutils literal notranslate"><span class="pre">--path</span></code>, the result of <code class="docutils literal notranslate"><span class="pre">dump</span></code> command includes <code class="docutils literal notranslate"><span class="pre">--path</span></code> informations.</p>
<ul>
<li><p>Therefore, if we specify <code class="docutils literal notranslate"><span class="pre">--path</span></code>, we can’t restore to host in different enviroment.</p>
<ul>
<li><p>Because the directory configuration and the location of <code class="docutils literal notranslate"><span class="pre">groonga</span></code> process in different by each enviroment.</p></li>
</ul>
</li>
<li><p>If we don’t want include <code class="docutils literal notranslate"><span class="pre">--path</span></code> informations to a dump, we need specify <code class="docutils literal notranslate"><span class="pre">--dump_paths</span> <span class="pre">no</span></code> in <code class="docutils literal notranslate"><span class="pre">dump</span></code> command.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/dump.html"><span class="doc">dump</span></a>] Added a new option <code class="docutils literal notranslate"><span class="pre">--dump_paths</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">--dump_paths</span></code> option control whether <code class="docutils literal notranslate"><span class="pre">--path</span></code> is dumped or not.</p></li>
<li><p>The default value of it is <code class="docutils literal notranslate"><span class="pre">yes</span></code>.</p></li>
<li><p>If we specify <code class="docutils literal notranslate"><span class="pre">--path</span></code> when we create tables or columns and we don’t want include <code class="docutils literal notranslate"><span class="pre">--path</span></code> informations to a dump, we specify <code class="docutils literal notranslate"><span class="pre">no</span></code> into <code class="docutils literal notranslate"><span class="pre">--dump_paths</span></code> when we execute <code class="docutils literal notranslate"><span class="pre">dump</span></code> command.</p></li>
</ul>
</li>
<li><p>[functions] Added a new function <code class="docutils literal notranslate"><span class="pre">string_toknize()</span></code>.</p>
<ul>
<li><p>It tokenizes the column value that is specified in the second argument with the tokenizer that is specified in the first argument.</p></li>
</ul>
</li>
<li><p>[tokenizers] Added a new tokenizer <code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorTFIDF</span></code> (experimental).</p>
<ul>
<li><p>It generates automatically document vector by TF-IDF.</p></li>
</ul>
</li>
<li><p>[tokenizers] Added a new tokenizer <code class="docutils literal notranslate"><span class="pre">TokenDocumentVectorBM25</span></code> (experimental).</p>
<ul>
<li><p>It generates automatically document vector by BM25.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for near search in same sentence.</p></li>
</ul>
</section>
<section id="id11">
<h3>Fixes<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>[<a class="reference internal" href="../reference/commands/load.html"><span class="doc">load</span></a>] Fixed a bug that <code class="docutils literal notranslate"><span class="pre">load</span></code> didn’t a return response when we executed it against 257 columns.</p>
<ul>
<li><p>This bug may occur from 10.0.4 or later.</p></li>
<li><p>This bug only occur when we load data by using <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">...]</span></code> format.</p>
<ul>
<li><p>If we load data by using <code class="docutils literal notranslate"><span class="pre">[{...}]</span></code>, this bug doesn’t occur.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[MessagePack] Fixed a bug that float32 value wasn’t unpacked correctly.</p></li>
<li><p>Fixed the following bugs related multi column index.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">_score</span></code> may be broken with full text search.</p></li>
<li><p>The records that couldn’t hit might hit.</p></li>
<li><p>Please refer to the following URL for the details about occurrence conditionin of this bug.</p>
<ul>
<li><p><a class="reference external" href="https://groonga.org/en/blog/2020/09/29/groonga-10.0.7.html#multi-column-index">https://groonga.org/en/blog/2020/09/29/groonga-10.0.7.html#multi-column-index</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="release-10-0-6-2020-08-29">
<span id="release-10-0-6"></span><h2>Release 10.0.6 - 2020-08-29<a class="headerlink" href="#release-10-0-6-2020-08-29" title="Link to this heading">#</a></h2>
<section id="id12">
<h3>Improvements<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>[<a class="reference internal" href="../reference/commands/logical_range_filter.html"><span class="doc">logical_range_filter</span></a>] Improved search plan for large data.</p>
<ul>
<li><p>Normally, <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> is faster than <code class="docutils literal notranslate"><span class="pre">logical_select</span></code>.
However, it had been slower than <code class="docutils literal notranslate"><span class="pre">logical_select</span></code> in the below case.</p>
<ul>
<li><p>If Groonga can’t get the number of required records easily, it has the feature that switches index search from sequential search. (Normally, <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> uses a sequential search when records of search target are many.)</p></li>
<li><p>The search process for it is almost the same as <code class="docutils literal notranslate"><span class="pre">logical_select</span></code> if the above switching occurred.
So, <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> is severalfold slower than <code class="docutils literal notranslate"><span class="pre">logical_select</span></code> in the above case if the search target is large data.
Because <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> executes sort after the search.</p></li>
</ul>
</li>
<li><p>If we search for large data, Groonga easily use sequential search than until now since this release.</p></li>
<li><p>Therefore, <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> will improve performance. Because the case of the search process almost the same as <code class="docutils literal notranslate"><span class="pre">logical_select</span></code> decreases.</p></li>
</ul>
</li>
<li><p>[httpd] Updated bundled nginx to 1.19.1.</p></li>
<li><p>Modify how to install into Debian GNU/Linux.</p>
<ul>
<li><p>We modify to use <code class="docutils literal notranslate"><span class="pre">groonga-apt-source</span></code> instead of <code class="docutils literal notranslate"><span class="pre">groonga-archive-keyring</span></code>. Because the <code class="docutils literal notranslate"><span class="pre">lintian</span></code> command recommends using <code class="docutils literal notranslate"><span class="pre">apt-source</span></code> if a package that it puts files under the <code class="docutils literal notranslate"><span class="pre">/etc/apt/sources.lists.d/</span></code>.</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">lintian</span></code> command is the command which checks for many common packaging errors.</p></li>
<li><p>Please also refer to the following URL for the details about installation procedures.</p>
<ul>
<li><p><a class="reference external" href="https://groonga.org/docs/install/debian.html">https://groonga.org/docs/install/debian.html</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/logical_select.html"><span class="doc">logical_select</span></a>] Added a support for <code class="docutils literal notranslate"><span class="pre">highlight_html</span></code> and <code class="docutils literal notranslate"><span class="pre">highlight_full</span></code> .</p></li>
<li><p>Added support for recycling the IDs of records that are deleted when an array without value space delete.[GitHub#mroonga/mroonga#327][Reported by gaeeyo]</p>
<ul>
<li><p>If an array that doesn’t have value space is deleted, deleted IDs are never recycled.</p></li>
<li><p>Groonga had used large storage space by large ID. Because it uses large storage space by itself.</p>
<ul>
<li><p>For example, large ID is caused after many adds and deletes like Mroonga’s <code class="docutils literal notranslate"><span class="pre">mroonga_operations</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved performance of full-text-search without index.</p></li>
<li><p>[<a class="reference internal" href="../reference/function.html"><span class="doc">Function</span></a>] Improved performance for calling of function that all arguments a variable reference or literal.</p></li>
<li><p>[<a class="reference internal" href="../reference/indexing.html"><span class="doc">Indexing</span></a>] Improved performance of offline index construction by using token column. [GitHub#1126][Patched by naoa]</p></li>
<li><p>Improved performance for <code class="docutils literal notranslate"><span class="pre">&quot;_score</span> <span class="pre">=</span> <span class="pre">func(...)&quot;</span></code>.</p>
<ul>
<li><p>The performance when the <code class="docutils literal notranslate"><span class="pre">_score</span></code> value calculate by using only function like <code class="docutils literal notranslate"><span class="pre">&quot;_score</span> <span class="pre">=</span> <span class="pre">func(...)&quot;</span></code> improved.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id13">
<h3>Fixes<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fixed a bug that garbage may be included in response after response send error.</p>
<ul>
<li><p>It may occur if a client didn’t read all responses and closed the connection.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id14">
<h3>Thanks<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>gaeeyo</p></li>
<li><p>naoa</p></li>
</ul>
</section>
</section>
<section id="release-10-0-5-2020-07-30">
<span id="release-10-0-5"></span><h2>Release 10.0.5 - 2020-07-30<a class="headerlink" href="#release-10-0-5-2020-07-30" title="Link to this heading">#</a></h2>
<section id="id15">
<h3>Improvements<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for storing reference in table that we specify with <code class="docutils literal notranslate"><span class="pre">--load_table</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">--load_table</span></code> is a feature that stores search results to the table in a prepared.</p>
<ul class="simple">
<li><p>If the searches are executed multiple times, we can cache the search results by storing them to this table.</p></li>
<li><p>We can shorten the search times that the search after the first time by using this table.</p></li>
</ul>
</li>
<li><p>We can store a reference to other tables into the key of this table as below since this release.</p>
<ul class="simple">
<li><p>We can make a smaller size of this table. Because we only store references without store column values.</p></li>
<li><p>If we search against this table, we can search by using indexes for reference destination.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Logs</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">Logs</span> <span class="n">timestamp</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Time</span>

<span class="n">table_create</span> <span class="n">Times</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">Time</span>
<span class="n">column_create</span> <span class="n">Times</span> <span class="n">logs_timestamp</span> <span class="n">COLUMN_INDEX</span> <span class="n">Logs</span> <span class="n">timestamp</span>

<span class="n">table_create</span> <span class="n">LoadedLogs</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">Logs</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Logs</span>
<span class="p">[</span>
<span class="p">{</span>
  <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-02-03:1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-02-03 10:49:00&quot;</span>
<span class="p">},</span>
<span class="p">{</span>
  <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-02-03:2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-02-03 12:49:00&quot;</span>
<span class="p">},</span>
<span class="p">{</span>
  <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-02-04:1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-02-04 00:00:00&quot;</span>
<span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> \
  <span class="n">Logs</span> \
  <span class="o">--</span><span class="n">load_table</span> <span class="n">LoadedLogs</span> \
  <span class="o">--</span><span class="n">load_columns</span> <span class="s2">&quot;_key&quot;</span> \
  <span class="o">--</span><span class="n">load_values</span> <span class="s2">&quot;_key&quot;</span> \
  <span class="o">--</span><span class="n">limit</span> <span class="mi">0</span>

<span class="n">select</span> \
  <span class="o">--</span><span class="n">table</span> <span class="n">LoadedLogs</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;timestamp &gt;= &quot;2015-02-03 12:49:00&quot;&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">2</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Time&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;2015-02-03:2&quot;</span><span class="p">,</span>
        <span class="mf">1422935340.0</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;2015-02-04:1&quot;</span><span class="p">,</span>
        <span class="mf">1422975600.0</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved sort performance on below cases.</p>
<ul class="simple">
<li><p>When many sort keys need ID resolution.</p>
<ul>
<li><p>For example, the following expression needs ID resolution.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">true</span> <span class="pre">--sort_keys</span> <span class="pre">column</span></code></p></li>
</ul>
</li>
<li><p>For example, the following expression doesn’t need ID resolution.
Because the <code class="docutils literal notranslate"><span class="pre">_score</span></code> pseudo column exists in the result table not the source table.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">true</span> <span class="pre">--sort_keys</span> <span class="pre">_score</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>When a sort target table has a key.</p>
<ul>
<li><p>Therefore, <code class="docutils literal notranslate"><span class="pre">TABLE_NO_KEY</span></code> isn’t supported this improvement.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved performance a bit on below cases.</p>
<ul class="simple">
<li><p>A case of searching for many records matches.</p></li>
<li><p>A case of drilldown for many records.</p></li>
</ul>
</li>
<li><p>[aggregator] Added support for score accessor for target. [GitHub#1120][Patched by naoa]</p>
<ul>
<li><p>For example, we can <code class="docutils literal notranslate"><span class="pre">_score</span></code> subject to <code class="docutils literal notranslate"><span class="pre">aggregator_*</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Items</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">Items</span> <span class="n">price</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">column_create</span> <span class="n">Items</span> <span class="n">tag</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Items</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Book&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Note&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Box&quot;</span><span class="p">,</span>   <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Pen&quot;</span><span class="p">,</span>   <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Food&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Drink&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Items</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="n">true</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span> <span class="n">tag</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">_nsubrecs</span><span class="p">,</span><span class="n">score_mean</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">score_mean</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">group</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">score_mean</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">Float</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">score_mean</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">score_mean</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;aggregator_mean(_score)&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">6</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;price&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;tag&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Book&quot;</span><span class="p">,</span>
        <span class="mi">1000</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;Note&quot;</span><span class="p">,</span>
        <span class="mi">1000</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;Box&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;Pen&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;Food&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="s2">&quot;C&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;Drink&quot;</span><span class="p">,</span>
        <span class="mi">300</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">]</span>
    <span class="p">],</span>
    <span class="p">{</span>
      <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span>
          <span class="mi">3</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="p">[</span>
            <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ShortText&quot;</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="s2">&quot;_nsubrecs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Int32&quot;</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="s2">&quot;score_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Float&quot;</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;A&quot;</span><span class="p">,</span>
          <span class="mi">2</span><span class="p">,</span>
          <span class="mf">1.0</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;B&quot;</span><span class="p">,</span>
          <span class="mi">3</span><span class="p">,</span>
          <span class="mf">1.0</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;C&quot;</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">,</span>
          <span class="mf">1.0</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/indexing.html"><span class="doc">Indexing</span></a>] Improved performance of offline index construction on VC++ version.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Use <code class="docutils literal notranslate"><span class="pre">null</span></code> instead <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, <code class="docutils literal notranslate"><span class="pre">Infinity</span></code>, and <code class="docutils literal notranslate"><span class="pre">-Infinity</span></code> when Groonga outputs result for JSON format.</p>
<ul class="simple">
<li><p>Because JSON doesn’t support them.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Add support fot aggregating standard deviation value.</p>
<ul>
<li><p>For example, we can calculate a standard deviation for every group as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Items</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">Items</span> <span class="n">price</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">column_create</span> <span class="n">Items</span> <span class="n">tag</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Items</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Book&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Note&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Box&quot;</span><span class="p">,</span>   <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Pen&quot;</span><span class="p">,</span>   <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Food&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Drink&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Items</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span> <span class="n">tag</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">_nsubrecs</span><span class="p">,</span><span class="n">price_sd</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sd</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">group</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sd</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">Float</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sd</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sd</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;aggregator_sd(price)&#39;</span> \
  <span class="o">--</span><span class="n">output_pretty</span> <span class="n">yes</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1594339851.924836</span><span class="p">,</span>
    <span class="mf">0.002813816070556641</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">6</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;price&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;tag&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Book&quot;</span><span class="p">,</span>
        <span class="mi">1000</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;Note&quot;</span><span class="p">,</span>
        <span class="mi">1000</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;Box&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;Pen&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;Food&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="s2">&quot;C&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;Drink&quot;</span><span class="p">,</span>
        <span class="mi">300</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">]</span>
    <span class="p">],</span>
    <span class="p">{</span>
      <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span>
          <span class="mi">3</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="p">[</span>
            <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ShortText&quot;</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="s2">&quot;_nsubrecs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Int32&quot;</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="s2">&quot;price_sd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Float&quot;</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;A&quot;</span><span class="p">,</span>
          <span class="mi">2</span><span class="p">,</span>
          <span class="mf">250.0</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;B&quot;</span><span class="p">,</span>
          <span class="mi">3</span><span class="p">,</span>
          <span class="mf">294.3920288775949</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;C&quot;</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">,</span>
          <span class="mf">0.0</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We can also calculate sample standard deviation to specifing <code class="docutils literal notranslate"><span class="pre">aggregate_sd(target,</span> <span class="pre">{&quot;unbiased&quot;:</span> <span class="pre">true})</span></code>.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[Windows] Dropped Visual Studio 2013 support.</p></li>
</ul>
</section>
<section id="id16">
<h3>Fixes<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>[<a class="reference internal" href="../reference/executables/groonga-server-http.html"><span class="doc">Groonga HTTP server</span></a>] Fixed a bug that a request can’t halt even if we execute <code class="docutils literal notranslate"><span class="pre">shutdown?mode=immediate</span></code> when the response was halted by error occurrence.</p></li>
<li><p>Fixed a crash bug when an error occurs while a request.</p>
<ul>
<li><p>It only occurs when we use Apache Arrow Format.</p></li>
<li><p>Groonga crashes when we send request to Groonga again after the previous request was halted by error occurrence.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/functions/between.html"><span class="doc">between</span></a>] Fixed a crash bug when temporary table is used.</p>
<ul>
<li><p>For example, if we specify a dynamic column in the first argument for <code class="docutils literal notranslate"><span class="pre">between</span></code>, Groonga had crashed.</p></li>
</ul>
</li>
<li><p>Fixed a bug that procedure created by plugin is freed unexpectedly.</p>
<ul>
<li><p>It’s only occurred in reference count mode.</p></li>
<li><p>It’s not occurred if we don’t use <code class="docutils literal notranslate"><span class="pre">plugin_register</span></code>.</p></li>
<li><p>It’s not occurred in the process that executes <code class="docutils literal notranslate"><span class="pre">plugin_register</span></code>.</p></li>
<li><p>It’s occurred in the process that doesn’t execute <code class="docutils literal notranslate"><span class="pre">plugin_register</span></code>.</p></li>
</ul>
</li>
<li><p>Fixed a bug that normalization error occurred while static index construction by <code class="docutils literal notranslate"><span class="pre">token_column</span></code>. [GitHub#1122][Reported by naoa]</p></li>
</ul>
</section>
<section id="id17">
<h3>Thanks<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>naoa</p></li>
</ul>
</section>
</section>
<section id="release-10-0-4-2020-06-29">
<span id="release-10-0-4"></span><h2>Release 10.0.4 - 2020-06-29<a class="headerlink" href="#release-10-0-4-2020-06-29" title="Link to this heading">#</a></h2>
<section id="id18">
<h3>Improvements<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/tables.html"><span class="doc">Tables</span></a>] Added support for registering 400M records into a hash table.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improve scorer performance when the <code class="docutils literal notranslate"><span class="pre">_score</span></code> doesn’t get recursively values.</p>
<ul class="simple">
<li><p>Groonga get recursively value of <code class="docutils literal notranslate"><span class="pre">_score</span></code> when search result is search target.</p></li>
<li><p>For example, the search targets of <code class="docutils literal notranslate"><span class="pre">slices</span></code> are search result. Therefore, if we use <code class="docutils literal notranslate"><span class="pre">slice</span></code> in a query, this improvement doesn’t ineffective.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/log.html"><span class="doc">Log</span></a>] Improved that we output drilldown keys in query-log.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/reference_acquire.html"><span class="doc">reference_acquire</span></a>], [<a class="reference internal" href="../reference/commands/reference_release.html"><span class="doc">reference_release</span></a>] Added new commands for reference count mode.</p>
<ul class="simple">
<li><p>If we need to call multiple <code class="docutils literal notranslate"><span class="pre">load</span></code> in a short time, auto close by the reference count mode will degrade performance.</p></li>
<li><p>We can avoid the performance degrading by calling <code class="docutils literal notranslate"><span class="pre">/reference_acquire</span></code> before multiple <code class="docutils literal notranslate"><span class="pre">load</span></code> and calling <code class="docutils literal notranslate"><span class="pre">/reference_release</span></code> after multiple <code class="docutils literal notranslate"><span class="pre">load</span></code>.
Between <code class="docutils literal notranslate"><span class="pre">/reference_acquire</span></code> and <code class="docutils literal notranslate"><span class="pre">/reference_release</span></code>, auto close is disabled.</p>
<ul>
<li><p>Because <code class="docutils literal notranslate"><span class="pre">/reference_acquire</span></code> acquires a reference of target objects.</p></li>
</ul>
</li>
<li><p>We can must call <code class="docutils literal notranslate"><span class="pre">/reference_release</span></code> after you finish performance impact operations.</p></li>
<li><p>If we don’t call <code class="docutils literal notranslate"><span class="pre">/reference_release</span></code>, the reference count mode doesn’t work.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for aggregating multiple groups on one time <code class="docutils literal notranslate"><span class="pre">drilldown</span></code>.</p>
<ul>
<li><p>We came to be able to calculate sum or arithmetic mean every different multiple groups on one time <code class="docutils literal notranslate"><span class="pre">drilldown</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Items</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">Items</span> <span class="n">price</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">column_create</span> <span class="n">Items</span> <span class="n">quantity</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">column_create</span> <span class="n">Items</span> <span class="n">tag</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Items</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Book&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Note&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Box&quot;</span><span class="p">,</span>   <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Pen&quot;</span><span class="p">,</span>   <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Food&quot;</span><span class="p">,</span>  <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Drink&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>  <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>  <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Items</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span> <span class="n">tag</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">_nsubrecs</span><span class="p">,</span><span class="n">price_sum</span><span class="p">,</span><span class="n">quantity_sum</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sum</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">group</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sum</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">UInt32</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sum</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">price_sum</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;aggregator_sum(price)&#39;</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">quantity_sum</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">group</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">quantity_sum</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">UInt32</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">quantity_sum</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">drilldowns</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">quantity_sum</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="s1">&#39;aggregator_sum(quantity)&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">6</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;price&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;quantity&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;tag&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Book&quot;</span><span class="p">,</span>
        <span class="mi">1000</span><span class="p">,</span>
        <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;Note&quot;</span><span class="p">,</span>
        <span class="mi">1000</span><span class="p">,</span>
        <span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;Box&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="mi">15</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;Pen&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="mi">12</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;Food&quot;</span><span class="p">,</span>
        <span class="mi">500</span><span class="p">,</span>
        <span class="mi">111</span><span class="p">,</span>
        <span class="s2">&quot;C&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;Drink&quot;</span><span class="p">,</span>
        <span class="mi">300</span><span class="p">,</span>
        <span class="mi">22</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span>
      <span class="p">]</span>
    <span class="p">],</span>
    <span class="p">{</span>
      <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span>
          <span class="mi">3</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="p">[</span>
            <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ShortText&quot;</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="s2">&quot;_nsubrecs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Int32&quot;</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="s2">&quot;price_sum&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UInt32&quot;</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="s2">&quot;quantity_sum&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UInt32&quot;</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;A&quot;</span><span class="p">,</span>
          <span class="mi">2</span><span class="p">,</span>
          <span class="mi">1500</span><span class="p">,</span>
          <span class="mi">112</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;B&quot;</span><span class="p">,</span>
          <span class="mi">3</span><span class="p">,</span>
          <span class="mi">1800</span><span class="p">,</span>
          <span class="mi">47</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;C&quot;</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">,</span>
          <span class="mi">500</span><span class="p">,</span>
          <span class="mi">111</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/executables/groonga.html"><span class="doc">groonga executable file</span></a>] Added support for <code class="docutils literal notranslate"><span class="pre">--pid-path</span></code> in standalone mode.</p>
<ul class="simple">
<li><p>Because <code class="docutils literal notranslate"><span class="pre">--pid-path</span></code> had been ignored in standalone mode in before version.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/io_flush.html"><span class="doc">io_flush</span></a>] Added support for reference count mode.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/logical_range_filter.html"><span class="doc">logical_range_filter</span></a>], [<a class="reference internal" href="../reference/commands/logical_count.html"><span class="doc">logical_count</span></a>] Added support for reference count mode.</p></li>
<li><p>[<a class="reference internal" href="../reference/executables/groonga-server-http.html"><span class="doc">Groonga HTTP server</span></a>] We didn’t add header after the last chunk.</p>
<ul class="simple">
<li><p>Because there is a possibility to exist that the HTTP client ignores header after the last chunk.</p></li>
</ul>
</li>
<li><p>[vector_slice] Added support for a vector that has the value of the <code class="docutils literal notranslate"><span class="pre">Float32</span></code> type. [GitHub#1112 patched by naoa]</p></li>
<li><p>Added support for parallel offline index construction using token column.</p>
<ul class="simple">
<li><p>We came to be able to construct an offline index on parallel threads from data that are tokenized in advance.</p></li>
<li><p>We can tune parameters of parallel offline construction by the following environment variables</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">GRN_TOKEN_COLUMN_PARALLEL_CHUNK_SIZE</span></code> : We specify how many records are processed per thread.</p>
<ul>
<li><p>The default value is <code class="docutils literal notranslate"><span class="pre">1024</span></code> records.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">GRN_TOKEN_COLUMN_PARALLEL_TABLE_SIZE_THRESHOLD</span></code> : We specify how many source records are required for parallel offline construction.</p>
<ul>
<li><p>The default value is <code class="docutils literal notranslate"><span class="pre">102400</span></code> records.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved performance for <code class="docutils literal notranslate"><span class="pre">load_table</span></code> on the reference count mode.</p></li>
</ul>
</section>
<section id="id19">
<h3>Fixes<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fixed a bug that the database of Groonga was broken when we search by using the dynamic columns that don’t specify a <code class="docutils literal notranslate"><span class="pre">--filter</span></code> and stridden over shard.</p></li>
<li><p>Fixed a bug that <code class="docutils literal notranslate"><span class="pre">Float32</span></code> type had not displayed on a result of <code class="docutils literal notranslate"><span class="pre">schema</span></code> command.</p></li>
<li><p>Fixed a bug that we count in surplus to <code class="docutils literal notranslate"><span class="pre">_nsubrecs</span></code> when the reference <code class="docutils literal notranslate"><span class="pre">uvector</span></code> hasn’t element.</p></li>
</ul>
</section>
<section id="id20">
<h3>Thanks<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>naoa</p></li>
</ul>
</section>
</section>
<section id="release-10-0-3-2020-05-29">
<span id="release-10-0-3"></span><h2>Release 10.0.3 - 2020-05-29<a class="headerlink" href="#release-10-0-3-2020-05-29" title="Link to this heading">#</a></h2>
<section id="id21">
<h3>Improvements<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<ul>
<li><p>We came to be able to construct an inverted index from data that are tokenized in advance.</p>
<ul>
<li><p>The construct of an index is speeded up from this.</p></li>
<li><p>We need to prepare token column to use this improvement.</p></li>
<li><p>token column is an auto generated value column like an index column.</p></li>
<li><p>token column value is generated from source column value by tokenizing the source column value.</p></li>
<li><p>We can create a token column by setting the source column as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerNFKC121</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenNgram</span>

<span class="n">table_create</span> <span class="n">Notes</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Notes</span> <span class="n">title</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>

<span class="c1"># The last &quot;title&quot; is the source column.</span>
<span class="n">column_create</span> <span class="n">Notes</span> <span class="n">title_terms</span> <span class="n">COLUMN_VECTOR</span> <span class="n">Terms</span> <span class="n">title</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] We came to be able to specify a <code class="docutils literal notranslate"><span class="pre">vector</span></code> for the argument of a function.</p>
<ul>
<li><p>For example, <code class="docutils literal notranslate"><span class="pre">flags</span></code> options of <code class="docutils literal notranslate"><span class="pre">query</span></code> can describe by a <code class="docutils literal notranslate"><span class="pre">vector</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> \
  <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;query(&quot;content&quot;, &quot;-content:@mroonga&quot;, </span><span class="se">\</span>
<span class="s1">                  { </span><span class="se">\</span>
<span class="s1">                    &quot;expander&quot;: &quot;QueryExpanderTSV&quot;, </span><span class="se">\</span>
<span class="s1">                    &quot;flags&quot;: [&quot;ALLOW_LEADING_NOT&quot;, &quot;ALLOW_COLUMN&quot;] </span><span class="se">\</span>
<span class="s1">                  })&#39;</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added a new stage <code class="docutils literal notranslate"><span class="pre">result_set</span></code> for dynamic columns.</p>
<ul class="simple">
<li><p>This stage generates a column into a result set table. Therefore, it is not generated if <code class="docutils literal notranslate"><span class="pre">query</span></code> or <code class="docutils literal notranslate"><span class="pre">filter</span></code> doesn’t exist</p>
<ul>
<li><p>Because if <code class="docutils literal notranslate"><span class="pre">query</span></code> or <code class="docutils literal notranslate"><span class="pre">filter</span></code> doesn’t exist, Groonga doesn’t make a result set table.</p></li>
</ul>
</li>
<li><p>We can’t use <code class="docutils literal notranslate"><span class="pre">_value</span></code> for the stage. The <code class="docutils literal notranslate"><span class="pre">result_set</span></code> stage is for storing value by <code class="docutils literal notranslate"><span class="pre">score_column</span></code>.</p></li>
</ul>
</li>
<li><p>[vector_slice] Added support for weight vector that has weight of <code class="docutils literal notranslate"><span class="pre">Float32</span></code> type. [GitHub#1106 patched by naoa]</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for <code class="docutils literal notranslate"><span class="pre">filtered</span></code> stage and <code class="docutils literal notranslate"><span class="pre">output</span></code> stage of dynamic columns on drilldowns. [GitHub#1101 patched by naoa][GitHub#1100 patched by naoa]</p>
<ul class="simple">
<li><p>We can use <code class="docutils literal notranslate"><span class="pre">filtered</span></code> and <code class="docutils literal notranslate"><span class="pre">output</span></code> stage of dynamic columns on drilldowns as with <code class="docutils literal notranslate"><span class="pre">drilldowns[Label].stage</span> <span class="pre">filtered</span></code> and <code class="docutils literal notranslate"><span class="pre">drilldowns[Label].stage</span> <span class="pre">output</span></code>.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for <code class="docutils literal notranslate"><span class="pre">Float</span></code> type value in aggregating on drilldown.</p>
<ul class="simple">
<li><p>We can aggregate max value, min value, and sum value for <code class="docutils literal notranslate"><span class="pre">Float</span></code> type value using <code class="docutils literal notranslate"><span class="pre">MAX</span></code>, <code class="docutils literal notranslate"><span class="pre">MIN</span></code>, and <code class="docutils literal notranslate"><span class="pre">SUM</span></code>.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/functions/query.html"><span class="doc">query</span></a>] [<a class="reference internal" href="../reference/functions/geo_in_rectangle.html"><span class="doc">geo_in_rectangle</span></a>] [<a class="reference internal" href="../reference/functions/geo_in_circle.html"><span class="doc">geo_in_circle</span></a>] Added a new option <code class="docutils literal notranslate"><span class="pre">score_column</span></code> for <code class="docutils literal notranslate"><span class="pre">query()</span></code>, <code class="docutils literal notranslate"><span class="pre">geo_in_rectangle()</span></code>, and <code class="docutils literal notranslate"><span class="pre">geo_in_circle()</span></code>.</p>
<ul class="simple">
<li><p>We can store a score value by condition using <code class="docutils literal notranslate"><span class="pre">score_column</span></code>.</p></li>
<li><p>Normally, Groonga calculate a score by adding scores of all conditions. However, we sometimes want to get a score value by condition.</p></li>
<li><p>For example, if we want to only use how near central coordinate as score as below, we use <code class="docutils literal notranslate"><span class="pre">score_column</span></code>.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">LandMarks</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">LandMarks</span> <span class="n">name</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">LandMarks</span> <span class="n">category</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">LandMarks</span> <span class="n">point</span> <span class="n">COLUMN_SCALAR</span> <span class="n">WGS84GeoPoint</span>

<span class="n">table_create</span> <span class="n">Points</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">WGS84GeoPoint</span>
<span class="n">column_create</span> <span class="n">Points</span> <span class="n">land_mark_index</span> <span class="n">COLUMN_INDEX</span> <span class="n">LandMarks</span> <span class="n">point</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">LandMarks</span>
<span class="p">[</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Aries&quot;</span>      <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Tower&quot;</span>     <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;11x11&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Taurus&quot;</span>     <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Lighthouse&quot;</span><span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;9x10&quot;</span> <span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gemini&quot;</span>     <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Lighthouse&quot;</span><span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;8x8&quot;</span>  <span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cancer&quot;</span>     <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Tower&quot;</span>     <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;12x12&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Leo&quot;</span>        <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Tower&quot;</span>     <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;11x13&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Virgo&quot;</span>      <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Temple&quot;</span>    <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;22x10&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Libra&quot;</span>      <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Tower&quot;</span>     <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;14x14&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Scorpio&quot;</span>    <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Temple&quot;</span>    <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;21x9&quot;</span> <span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sagittarius&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Temple&quot;</span>    <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;43x12&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Capricorn&quot;</span>  <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Tower&quot;</span>     <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;33x12&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Aquarius&quot;</span>   <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;mountain&quot;</span>  <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;55x11&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Pisces&quot;</span>     <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Tower&quot;</span>     <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;9x9&quot;</span>  <span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ophiuchus&quot;</span>  <span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;mountain&quot;</span>  <span class="p">,</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="s2">&quot;21x21&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">LandMarks</span> \
  <span class="o">--</span><span class="n">sort_keys</span> <span class="s1">&#39;distance&#39;</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">distance</span><span class="p">]</span><span class="o">.</span><span class="n">stage</span> <span class="n">initial</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">distance</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="n">Float</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">distance</span><span class="p">]</span><span class="o">.</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> \
  <span class="o">--</span><span class="n">columns</span><span class="p">[</span><span class="n">distance</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="mf">0.0</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;name, category, point, distance, _score&#39;</span> \
  <span class="o">--</span><span class="n">limit</span> <span class="o">-</span><span class="mi">1</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;geo_in_circle(point, &quot;11x11&quot;, &quot;11x1&quot;, {&quot;score_column&quot;: distance}) &amp;&amp; category == &quot;Tower&quot;&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1590647445.406149</span><span class="p">,</span>
    <span class="mf">0.0002503395080566406</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">5</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ShortText&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;category&quot;</span><span class="p">,</span><span class="s2">&quot;ShortText&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;point&quot;</span><span class="p">,</span>
          <span class="s2">&quot;WGS84GeoPoint&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;distance&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Float&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;_score&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Int32&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;Aries&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tower&quot;</span><span class="p">,</span>
        <span class="s2">&quot;11x11&quot;</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;Cancer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tower&quot;</span><span class="p">,</span>
        <span class="s2">&quot;12x12&quot;</span><span class="p">,</span>
        <span class="mf">0.0435875803232193</span><span class="p">,</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;Leo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tower&quot;</span><span class="p">,</span>
        <span class="s2">&quot;11x13&quot;</span><span class="p">,</span>
        <span class="mf">0.06164214760065079</span><span class="p">,</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;Pisces&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tower&quot;</span><span class="p">,</span>
        <span class="s2">&quot;9x9&quot;</span><span class="p">,</span>
        <span class="mf">0.0871751606464386</span><span class="p">,</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;Libra&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tower&quot;</span><span class="p">,</span>
        <span class="s2">&quot;14x14&quot;</span><span class="p">,</span>
        <span class="mf">0.1307627409696579</span><span class="p">,</span>
        <span class="mi">1</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The sort by <code class="docutils literal notranslate"><span class="pre">_score</span></code> is meaningless in the above example. Because the value of <code class="docutils literal notranslate"><span class="pre">_score</span></code> is all <code class="docutils literal notranslate"><span class="pre">1</span></code> by <code class="docutils literal notranslate"><span class="pre">category</span> <span class="pre">==</span> <span class="pre">&quot;Tower&quot;</span></code>.
However, we can sort distance from central coordinate using <code class="docutils literal notranslate"><span class="pre">score_column</span></code>.</p></li>
</ul>
</li>
<li><p>[Windows] Groonga came to be able to output backtrace when it occurs error even if it doesn’t crash.</p></li>
<li><p>[Windows] Dropped support for old Windows.</p>
<ul class="simple">
<li><p>Groonga for Windows come to require Windows 8 (Windows Server 2012) or later from 10.0.3.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved sort performance when sort keys were mixed referable sort keys and the other sort keys.</p>
<ul class="simple">
<li><p>We improved sort performance if mixed referable sort keys and the other and there are referable keys two or more.</p>
<ul>
<li><p>Referable sort keys are sort keys that except below them.</p>
<ul>
<li><p>Compressed columns</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_value</span></code> against the result of drilldown that is specified multiple values to the key of drilldown.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_key</span></code> against patricia trie table that has not the key of <code class="docutils literal notranslate"><span class="pre">ShortText</span></code> type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_score</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>The more sort keys that except string, a decrease in the usage of memory for sort.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improved sort performance when sort keys are all referable keys case.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Improve scorer performance as a <code class="docutils literal notranslate"><span class="pre">_socre</span> <span class="pre">=</span> <span class="pre">column1*X</span> <span class="pre">+</span> <span class="pre">column2*Y</span> <span class="pre">+</span> <span class="pre">...</span></code> case.</p>
<ul class="simple">
<li><p>This optimization effective when there are many <code class="docutils literal notranslate"><span class="pre">+</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code> in <code class="docutils literal notranslate"><span class="pre">_score</span></code>.</p></li>
<li><p>At the moment, it has only effective against <code class="docutils literal notranslate"><span class="pre">+</span></code> and <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for phrase near search.</p>
<ul>
<li><p>We can search phrase by phrase by a near search.</p>
<ul>
<li><p>Query syntax for near phrase search is <code class="docutils literal notranslate"><span class="pre">*NP&quot;Phrase1</span> <span class="pre">phrase2</span> <span class="pre">...&quot;</span></code>.</p></li>
<li><p>Script syntax for near phrase search is <code class="docutils literal notranslate"><span class="pre">column</span> <span class="pre">*NP</span> <span class="pre">&quot;phrase1</span> <span class="pre">phrase2</span> <span class="pre">...&quot;</span></code>.</p></li>
<li><p>If the search target phrase includes space, we can search for it by surrounding it with <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="s1">&#39;TokenNgram(&quot;unify_alphabet&quot;, false, </span><span class="se">\</span>
<span class="s1">                                  &quot;unify_digit&quot;, false)&#39;</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerNFKC121</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">entries_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">content</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I started to use Groonga. It&#39;s very fast!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I also started to use Groonga. It&#39;s also very fast! Really fast!&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;content *NP &quot;</span><span class="se">\\</span><span class="s1">&quot;I started</span><span class="se">\\</span><span class="s1">&quot; </span><span class="se">\\</span><span class="s1">&quot;use Groonga</span><span class="se">\\</span><span class="s1">&quot;&quot;&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;content&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1590469700.715882</span><span class="p">,</span>
    <span class="mf">0.03997230529785156</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;content&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Text&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;I started to use Groonga. It&#39;s very fast!&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/columns/vector.html"><span class="doc">Vector column</span></a>] Added support for <code class="docutils literal notranslate"><span class="pre">float32</span></code> weight vector.</p>
<ul>
<li><p>We can store weight as <code class="docutils literal notranslate"><span class="pre">float32</span></code> instead of <code class="docutils literal notranslate"><span class="pre">uint32</span></code>.</p></li>
<li><p>We need to add <code class="docutils literal notranslate"><span class="pre">WEIGHT_FLOAT32</span></code> flag when execute <code class="docutils literal notranslate"><span class="pre">column_create</span></code> to use this feature.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">column_create</span> <span class="n">Records</span> <span class="n">tags</span> <span class="n">COLUMN_VECTOR</span><span class="o">|</span><span class="n">WITH_WEIGHT</span><span class="o">|</span><span class="n">WEIGHT_FLOAT32</span> <span class="n">Tags</span>
</pre></div>
</div>
</li>
<li><p>However, <code class="docutils literal notranslate"><span class="pre">WEIGHT_FLOAT32</span></code> flag isn’t available with <code class="docutils literal notranslate"><span class="pre">COLUMN_INDEX</span></code> flag for now.</p></li>
</ul>
</li>
<li><p>Added following APIs</p>
<ul>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_obj_is_xxx</span></code> functions. For more information as below.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">grn_obj_is_weight_vector(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*obj)</span></code></p>
<ul>
<li><p>It returns as a <code class="docutils literal notranslate"><span class="pre">bool</span></code> whether the object is a weight vector.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_obj_is_uvector(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*obj)</span></code></p>
<ul>
<li><p>It returns as a <code class="docutils literal notranslate"><span class="pre">bool</span></code> whether the object is a <code class="docutils literal notranslate"><span class="pre">uvector</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">uvector</span></code> is a <code class="docutils literal notranslate"><span class="pre">vector</span></code> that size of elements for <code class="docutils literal notranslate"><span class="pre">vector</span></code> are fixed.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_obj_is_weight_uvector(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*obj)</span></code></p>
<ul>
<li><p>It returns as a <code class="docutils literal notranslate"><span class="pre">bool</span></code> whether the object is a weight uvector.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_type_id_size(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_id</span> <span class="pre">id)</span></code>.</p>
<ul class="simple">
<li><p>It returns the size of Groonga data type as a <code class="docutils literal notranslate"><span class="pre">size_t</span></code>.</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_xxx</span></code> functions. For more information as below.</p>
<ul class="simple">
<li><p>These functions return selector related data.</p>
<ul>
<li><p>These functions are supposed to call in selector. If they are called except in selector, they return <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get(grn_ctx</span> <span class="pre">*ctx)</span></code></p>
<ul>
<li><p>It returns all information that relating calling selector as <code class="docutils literal notranslate"><span class="pre">grn_selector_data</span> <span class="pre">*</span></code> structure.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_selector(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_selector_data</span> <span class="pre">*data)</span></code></p>
<ul>
<li><p>It returns selector itself as <code class="docutils literal notranslate"><span class="pre">grn_obj</span> <span class="pre">*</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_expr(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_selector_data</span> <span class="pre">*data)</span></code></p>
<ul>
<li><p>It returns selector is used <code class="docutils literal notranslate"><span class="pre">--filter</span></code> condition and <code class="docutils literal notranslate"><span class="pre">--query</span></code> condition as <code class="docutils literal notranslate"><span class="pre">grn_obj</span> <span class="pre">*</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_table(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_selector_data</span> <span class="pre">*data)</span></code></p>
<ul>
<li><p>It returns target table as <code class="docutils literal notranslate"><span class="pre">grn_obj</span> <span class="pre">*</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_index(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_selector_data</span> <span class="pre">*data)</span></code></p>
<ul>
<li><p>It returns index is used by selector as <code class="docutils literal notranslate"><span class="pre">grn_obj</span> <span class="pre">*</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_args(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_selector_data</span> <span class="pre">*data,</span> <span class="pre">size_t</span> <span class="pre">*n_args)</span></code></p>
<ul>
<li><p>It returns arguments of function that called selector as <code class="docutils literal notranslate"><span class="pre">grn_obj</span> <span class="pre">**</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_result_set(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_selector_data</span> <span class="pre">*data)</span></code></p>
<ul>
<li><p>It returns result table as <code class="docutils literal notranslate"><span class="pre">grn_obj</span> <span class="pre">*</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_selector_data_get_op(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_selector_data</span> <span class="pre">*data)</span></code></p>
<ul>
<li><p>It returns how to perform the set operation on existing result set as <code class="docutils literal notranslate"><span class="pre">grn_operator</span></code>.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_plugin_proc_xxx</span></code> functions. For more information as below.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_plugin_proc_get_value_operator(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*value,</span> <span class="pre">grn_operator</span> <span class="pre">default_operator,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*context)</span></code></p>
<ul class="simple">
<li><p>It returns the operator of a query as a <code class="docutils literal notranslate"><span class="pre">grn_operator</span></code>.</p>
<ul>
<li><p>For example, <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> is returned as a <code class="docutils literal notranslate"><span class="pre">GRN_OP_AND</span></code>.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_plugin_proc_get_value_bool(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*value,</span> <span class="pre">bool</span> <span class="pre">default_value,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*tag)</span></code></p>
<ul>
<li><p>It returns the value that is specified <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code> like <code class="docutils literal notranslate"><span class="pre">with_transposition</span></code> argument of the below function as a <code class="docutils literal notranslate"><span class="pre">bool</span></code> (<code class="docutils literal notranslate"><span class="pre">bool</span></code> is the data type of C language).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzy_search</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;max_distance&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;prefix_length&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;max_expansion&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;with_transposition&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_proc_options_xxx</span></code> functions. For more information as below.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">query()</span></code> only uses them for now.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_proc_options_parsev(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*options,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*tag,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*name,</span> <span class="pre">va_list</span> <span class="pre">args)</span></code></p>
<ul>
<li><p>This function execute parse options.</p></li>
<li><p>We had to implement parsing to options ourselves until now, however, we can parse them by just call this function from this version.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_proc_options_parse(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*options,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*tag,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*name,</span> <span class="pre">...)</span></code></p>
<ul>
<li><p>It calls <code class="docutils literal notranslate"><span class="pre">grn_proc_options_parsev()</span></code>. Therefore, features of this function same <code class="docutils literal notranslate"><span class="pre">grn_proc_options_parsev()</span></code>.</p></li>
<li><p>It only differs in the interface compare with <code class="docutils literal notranslate"><span class="pre">grn_proc_options_parsev()</span></code>.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_text_printfv(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*bulk,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*format,</span> <span class="pre">va_list</span> <span class="pre">args)</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">grn_text_vprintf</span></code> is deprecated from 10.0.3. We use <code class="docutils literal notranslate"><span class="pre">grn_text_printfv</span></code> instead.</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_type_id_is_float_family(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_id</span> <span class="pre">id)</span></code>.</p>
<ul class="simple">
<li><p>It returns whether <code class="docutils literal notranslate"><span class="pre">grn_type_id</span></code> is <code class="docutils literal notranslate"><span class="pre">GRN_DB_FLOAT32</span></code> or <code class="docutils literal notranslate"><span class="pre">GRN_DB_FLOAT</span></code> or not as a <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_dat_cursor_get_max_n_records(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_dat_cursor</span> <span class="pre">*c)</span></code>.</p>
<ul class="simple">
<li><p>It returns the number of max records the cursor can have as a <code class="docutils literal notranslate"><span class="pre">size_t</span></code>. (This API is for the DAT table)</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_table_cursor_get_max_n_records(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_table_cursor</span> <span class="pre">*cursor)</span></code>.</p>
<ul class="simple">
<li><p>It returns the number of max records the cursor can have as a <code class="docutils literal notranslate"><span class="pre">size_t</span></code>.</p></li>
<li><p>It can use against all table type (<code class="docutils literal notranslate"><span class="pre">TABLE_NO_KEY</span></code>, <code class="docutils literal notranslate"><span class="pre">TABLE_HASH_KEY</span></code>, <code class="docutils literal notranslate"><span class="pre">TABLE_DAT_KEY</span></code>, and <code class="docutils literal notranslate"><span class="pre">TABLE_PAT_KEY</span></code>).</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_result_set_add_xxx</span></code> functions. For more information as below.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">grn_result_set_add_record(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_hash</span> <span class="pre">*result_set,</span> <span class="pre">grn_posting</span> <span class="pre">*posting,</span> <span class="pre">grn_operator</span> <span class="pre">op)</span></code></p>
<ul>
<li><p>It adds a record into the table of result sets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_ii_posting_add_float</span></code> is deprecated from 10.0.3. We use <code class="docutils literal notranslate"><span class="pre">grn_rset_add_records()</span></code> instead.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_result_set_add_table(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_hash</span> <span class="pre">*result_set,</span> <span class="pre">grn_obj</span> <span class="pre">*table,</span> <span class="pre">double</span> <span class="pre">score,</span> <span class="pre">grn_operator</span> <span class="pre">op)</span></code></p>
<ul>
<li><p>It adds a table into the result sets.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_result_set_add_table_cursor(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_hash</span> <span class="pre">*result_set,</span> <span class="pre">grn_table_cursor</span> <span class="pre">*cursor,</span> <span class="pre">double</span> <span class="pre">score,</span> <span class="pre">grn_operator</span> <span class="pre">op)</span></code></p>
<ul>
<li><p>It adds records that a table cursor has into the result sets.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_vector_copy(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*src,</span> <span class="pre">grn_obj</span> <span class="pre">*dest)</span></code>.</p>
<ul class="simple">
<li><p>It copies a <code class="docutils literal notranslate"><span class="pre">vector</span></code> object. It returns whether success copy a <code class="docutils literal notranslate"><span class="pre">vector</span></code> object.</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_obj_have_source(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*obj)</span></code>.</p>
<ul class="simple">
<li><p>It returns whether the column has a source column as a <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_obj_is_token_column(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*obj)</span></code>.</p>
<ul class="simple">
<li><p>It returns whether the column is a token column as a <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p></li>
</ul>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">grn_hash_add_table_cursor(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_hash</span> <span class="pre">*hash,</span> <span class="pre">grn_table_cursor</span> <span class="pre">*cursor,</span> <span class="pre">double</span> <span class="pre">score)</span></code>.</p>
<ul class="simple">
<li><p>It’s for bulk result set insert. It’s faster than inserting records by <code class="docutils literal notranslate"><span class="pre">grn_ii_posting_add()</span></code>.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id22">
<h3>Fixes<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fixed a crash bug if the modules (tokenizers, normalizers, and token filters) are used at the same time from multiple threads.</p></li>
<li><p>Fixed precision of <code class="docutils literal notranslate"><span class="pre">Float32</span></code> value when it outputted.</p>
<ul>
<li><p>The precision of it changes to  8-digit to 7-digit from 10.0.3.</p></li>
</ul>
</li>
<li><p>Fixed a bug that Groonga used the wrong cache when the query that just the parameters of dynamic column different was executed. [GitHub#1102 patched by naoa]</p></li>
</ul>
</section>
<section id="id23">
<h3>Thanks<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>naoa</p></li>
</ul>
</section>
</section>
<section id="release-10-0-2-2020-04-29">
<span id="release-10-0-2"></span><h2>Release 10.0.2 - 2020-04-29<a class="headerlink" href="#release-10-0-2-2020-04-29" title="Link to this heading">#</a></h2>
<section id="id24">
<h3>Improvements<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<ul>
<li><p>Added support for <code class="docutils literal notranslate"><span class="pre">uvector</span></code> for <code class="docutils literal notranslate"><span class="pre">time_classify_*</span></code> functions. [GitHub#1089][Patched by naoa]</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">uvector</span></code> is a vector that size of elements for vector are fixed.</p></li>
<li><p>For example, a vector that has values of Time type as elements is a <code class="docutils literal notranslate"><span class="pre">uvector</span></code>.</p></li>
</ul>
</li>
<li><p>Improve sort performance if sort key that can’t refer value with zero-copy is mixed.</p>
<ul class="simple">
<li><p>Some sort key (e.g. <code class="docutils literal notranslate"><span class="pre">_score</span></code>) values can’t be referred with zero-copy.</p></li>
<li><p>If there is at least one sort key that can’t be referable is included, all sort keys are copied before.</p></li>
<li><p>With this change, we just copy sort keys that can’t be referred. Referable sort keys are just referred without a copy.</p></li>
<li><p>However, this change may have performance regression when all sort keys are referable.</p></li>
</ul>
</li>
<li><p>Added support for loading weight vector as a JSON string.</p>
<ul>
<li><p>We can load weight vector as a JSON string as below example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Tags</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span>
<span class="n">table_create</span> <span class="n">Data</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Data</span> <span class="n">tags</span> <span class="n">COLUMN_VECTOR</span><span class="o">|</span><span class="n">WITH_WEIGHT</span> <span class="n">Tags</span>
<span class="n">column_create</span> <span class="n">Tags</span> <span class="n">data_tags</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_WEIGHT</span> <span class="n">Data</span> <span class="n">tags</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Data</span>
<span class="p">[</span>
  <span class="p">{</span><span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">fruit</span><span class="se">\&quot;</span><span class="s2">: 10, </span><span class="se">\&quot;</span><span class="s2">apple</span><span class="se">\&quot;</span><span class="s2">: 100}&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">fruit</span><span class="se">\&quot;</span><span class="s2">: 200}&quot;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Added support for <code class="docutils literal notranslate"><span class="pre">Float32</span></code> type.</p>
<ul class="simple">
<li><p>Groonga already has a <code class="docutils literal notranslate"><span class="pre">Float</span></code> type. However, it is double precision floating point number. Therefore if we only use single precision floating point number, it is not efficient.</p></li>
<li><p>We can select more suitable type by adding a <code class="docutils literal notranslate"><span class="pre">Float32</span></code> type.</p></li>
</ul>
</li>
<li><p>Added following APIs</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_obj_unref(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_obj</span> <span class="pre">*obj)</span></code></p>
<ul>
<li><p>This API is only used on the reference count mode (The reference count mode is a state of <code class="docutils literal notranslate"><span class="pre">GRN_ENABLE_REFERENCE_COUNT=yes</span></code>.).</p>
<ul>
<li><p>It calls <code class="docutils literal notranslate"><span class="pre">grn_obj_unlink()</span></code> only on the reference count mode. It doesn’t do anything except when the reference count mode.</p></li>
<li><p>We useful it when we need only call <code class="docutils literal notranslate"><span class="pre">grn_obj_unlink()</span></code> on the referece count mode.</p></li>
<li><p>Because as the following example, we don’t write condition that whether the reference count mode or not.</p>
<ul>
<li><p>The example if we don’t use <code class="docutils literal notranslate"><span class="pre">grn_obj_unref()</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">grn_enable_reference_count</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">grn_obj_unlink</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>The example if we use <code class="docutils literal notranslate"><span class="pre">grn_obj_unref()</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grn_obj_ubref</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_get_version_major(void)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_get_version_minor(void)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_get_version_micro(void)</span></code></p>
<ul class="simple">
<li><p>They return Groonga’s major, minor, and micor version numbers as a <code class="docutils literal notranslate"><span class="pre">uint32_t</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_record_id(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_section_id(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_position(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_tf(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_weight(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_weight_float(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_rest(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p>
<ul class="simple">
<li><p>They return information on the posting list.</p></li>
<li><p>These APIs return value as a <code class="docutils literal notranslate"><span class="pre">uint32_t</span></code> except <code class="docutils literal notranslate"><span class="pre">grn_posting_get_weight_float</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_weight_float</span></code> returns value as a <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_section_id(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p>
<ul>
<li><p>Section id is the internal representation of the column name.</p></li>
<li><p>If column name store in posting list as a string, it is a large amount of information and it use waste capacity.</p></li>
<li><p>Therefore, Groonga compresses the amount of information and use storage capacity is small by storing column name in the posting list as a number called section id.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_tf(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tf</span></code> of <code class="docutils literal notranslate"><span class="pre">grn_posting_get_tf</span></code> is Term Frequency score.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grn_posting_get_weight_float(grn_ctx</span> <span class="pre">*ctx,</span> <span class="pre">grn_posting</span> <span class="pre">*posting)</span></code></p>
<ul>
<li><p>It returns weight of token as a <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p>We suggest using this API when we get a weight of token after this.</p>
<ul>
<li><p>Because we modify the internal representation of the weight from <code class="docutils literal notranslate"><span class="pre">uint32_t</span></code> to <code class="docutils literal notranslate"><span class="pre">float</span></code> in the near future.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id25">
<h3>Fixes<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fixed a bug that Groonga for 32bit on GNU/Linux may crash.</p></li>
<li><p>Fixed a bug that unrelated column value may be cleared. [GtiHub#1087][Reported by sutamin]</p></li>
<li><p>Fixed a memory leak when we dumped records with <code class="docutils literal notranslate"><span class="pre">dump</span></code> command.</p></li>
<li><p>Fixed a memory leak when we specified invalid value into <code class="docutils literal notranslate"><span class="pre">output_columns</span></code>.</p></li>
<li><p>Fixed a memory leak when we executed <code class="docutils literal notranslate"><span class="pre">snippet</span></code> function.</p></li>
<li><p>Fixed a memory leak when we filled the below conditions.</p>
<ul>
<li><p>If we used dynamic columns on the <code class="docutils literal notranslate"><span class="pre">initial</span></code> stage.</p></li>
<li><p>If we used <code class="docutils literal notranslate"><span class="pre">slices</span></code> argument with <code class="docutils literal notranslate"><span class="pre">select</span></code> command.</p></li>
</ul>
</li>
<li><p>Fixed a memory leak when we deleted tables with <code class="docutils literal notranslate"><span class="pre">logical_table_remove</span></code>.</p></li>
<li><p>Fixed a memory leak when we use the reference count mode.</p>
<ul>
<li><p>The reference count mode is a <code class="docutils literal notranslate"><span class="pre">GRN_ENABLE_REFERENCE_COUNT=yes</span></code> state.</p></li>
<li><p>This mode is experimental. Performance may degrade by this mode.</p></li>
</ul>
</li>
<li><p>Fixed a bug that Groonga too much unlink <code class="docutils literal notranslate"><span class="pre">_key</span></code> accessor when we load data for apache arrow format.</p></li>
</ul>
</section>
<section id="id26">
<h3>Thanks<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>sutamin</p></li>
<li><p>naoa</p></li>
</ul>
</section>
</section>
<section id="release-10-0-1-2020-03-30">
<span id="release-10-0-1"></span><h2>Release 10.0.1 - 2020-03-30<a class="headerlink" href="#release-10-0-1-2020-03-30" title="Link to this heading">#</a></h2>
<p>We have been released Groonga 10.0.1.
Because Ubuntu and Windows(VC++ version) package in Groonga 10.0.0 were mistaken.</p>
<p>If we have already used Groonga 10.0.0 for CentOS, Debian, Windows(MinGW version), no problem with continued use it.</p>
<section id="id27">
<h3>Fixes<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Added a missing runtime(vcruntime140_1.dll) in package for Windows VC++ version.</p></li>
</ul>
</section>
</section>
<section id="release-10-0-0-2020-03-29">
<span id="release-10-0-0"></span><h2>Release 10.0.0 - 2020-03-29<a class="headerlink" href="#release-10-0-0-2020-03-29" title="Link to this heading">#</a></h2>
<section id="id28">
<h3>Improvements<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<ul>
<li><p>[httpd] Updated bundled nginx to 1.17.9.</p></li>
<li><p>[httpd] Added support for specifying output type as an extension.</p>
<ul class="simple">
<li><p>For example, we can write <code class="docutils literal notranslate"><span class="pre">load.json</span></code> instead of <code class="docutils literal notranslate"><span class="pre">load?output_type=json</span></code>.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/log.html"><span class="doc">Log</span></a>] Outputted a path of opened or closed file into a log of dump level on Linux.</p></li>
<li><p>[<a class="reference internal" href="../reference/log.html"><span class="doc">Log</span></a>] Outputted a path of closed file into a log of debug level on Windows.</p></li>
<li><p>Added following API and macros</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">grn_timeval_from_double(grn_ctx,</span> <span class="pre">double)</span></code></p>
<ul>
<li><p>This API converts <code class="docutils literal notranslate"><span class="pre">double</span></code> type to <code class="docutils literal notranslate"><span class="pre">grn_timeval</span></code> type.</p></li>
<li><p>It returns value of <code class="docutils literal notranslate"><span class="pre">grn_timeval</span></code> type.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">GRN_TIMEVAL_TO_NSEC(timeval)</span></code></p>
<ul>
<li><p>This macro converts value of <code class="docutils literal notranslate"><span class="pre">grn_timeval</span></code> type to nanosecond as the value of <code class="docutils literal notranslate"><span class="pre">uint64_t</span></code> type.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">GRN_TIME_USEC_TO_SEC(usec)</span></code></p>
<ul>
<li><p>This macro converts microsecond to second.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Deprecated the following macro.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GRN_OBJ_FORMAT_FIN(grn_ctx,</span> <span class="pre">grn_obj_format)</span></code></p>
<ul>
<li><p>We <code class="docutils literal notranslate"><span class="pre">grn_obj_format_fin(grn_ctx,</span> <span class="pre">grn_obj_format)</span></code> use instead since 10.0.0.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/logical_range_filter.html"><span class="doc">logical_range_filter</span></a>],[<a class="reference internal" href="../reference/commands/dump.html"><span class="doc">dump</span></a>] Added support for stream output.</p>
<ul>
<li><p>This feature requires <code class="docutils literal notranslate"><span class="pre">command_version</span> <span class="pre">3</span></code> or later. The header content is outputted after the body content.</p></li>
<li><p>Currently, this feature support only <code class="docutils literal notranslate"><span class="pre">dump</span></code> and <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> always returns the output as a stream on <code class="docutils literal notranslate"><span class="pre">command_version</span> <span class="pre">3</span></code> or later.</p></li>
<li><p>This feature has the following limitations.</p>
<ul class="simple">
<li><p>-1 is only allowed for negative <code class="docutils literal notranslate"><span class="pre">limit</span></code></p></li>
<li><p>MessagePack output isn’t supported</p></li>
</ul>
</li>
<li><p>We a little changed the response contents of JSON by this modify.</p>
<ul>
<li><p>The key order differs from before versions as below.</p>
<ul>
<li><p>The key order in before versions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>The key order in this version(10.0.0).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
  <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Disabled caches of <code class="docutils literal notranslate"><span class="pre">dump</span></code> and <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> when they execute on <code class="docutils literal notranslate"><span class="pre">command_version</span> <span class="pre">3</span></code>.</p>
<ul class="simple">
<li><p>Because of <code class="docutils literal notranslate"><span class="pre">dump</span></code> and <code class="docutils literal notranslate"><span class="pre">logical_range_filter</span></code> on <code class="docutils literal notranslate"><span class="pre">command_version</span> <span class="pre">3</span></code> returns stream since 10.0.0, Groonga can not cache the whole response.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/logical_range_filter.html"><span class="doc">logical_range_filter</span></a>] Added support for outputting response as Apache Arrow format.</p>
<ul class="simple">
<li><p>Supported data type as below.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">UInt8</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Int8</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UInt16</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Int16</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UInt32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Int32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UInt64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Int64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Time</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ShortText</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Text</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LongText</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Vector</span></code> of <code class="docutils literal notranslate"><span class="pre">Int32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Reference</span> <span class="pre">vector</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>Supported Ubuntu 20.04 (Focal Fossa).</p></li>
<li><p>Dropped Ubuntu 19.04 (Disco Dingo).</p>
<ul class="simple">
<li><p>Because this version has been EOL.</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-1-1-2021-01-25">Release 10.1.1 - 2021-01-25</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#improvements">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixes">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thanks">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-1-0-2020-12-29">Release 10.1.0 - 2020-12-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-9-2020-12-01">Release 10.0.9 - 2020-12-01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Fixes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-8-2020-10-29">Release 10.0.8 - 2020-10-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-7-2020-09-29">Release 10.0.7 - 2020-09-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Fixes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-6-2020-08-29">Release 10.0.6 - 2020-08-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-5-2020-07-30">Release 10.0.5 - 2020-07-30</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-4-2020-06-29">Release 10.0.4 - 2020-06-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-3-2020-05-29">Release 10.0.3 - 2020-05-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-2-2020-04-29">Release 10.0.2 - 2020-04-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-1-2020-03-30">Release 10.0.1 - 2020-03-30</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Fixes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-10-0-0-2020-03-29">Release 10.0.0 - 2020-03-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Improvements</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/groonga/groonga/edit/main/doc/source/news/10.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2009-2024 Groonga Project.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>