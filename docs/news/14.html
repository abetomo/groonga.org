
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>News - 14 series &#8212; Groonga v14.0.4 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=7622bb8d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-7532323-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-7532323-1');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-7532323-1');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'news/14';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.3';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://groonga.org/docs/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'english';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

   

<a class="navbar-brand logo" href="https://groonga.org/">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/groonga.png" class="logo__image only-light" alt="Groonga v14.0.4 documentation - Home"/>
    <script>document.write(`<img src="../_static/groonga.png" class="logo__image only-dark" alt="Groonga v14.0.4 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/groonga/groonga" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/groonga" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="/blog" title="Blog" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-blog fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Blog</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/groonga/groonga" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/groonga" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="/blog" title="Blog" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-blog fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Blog</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">News - 14 series</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="news-14-series">
<h1>News - 14 series<a class="headerlink" href="#news-14-series" title="Link to this heading">#</a></h1>
<section id="release-14-0-4-2024-05-29">
<span id="release-14-0-4"></span><h2>Release 14.0.4 - 2024-05-29<a class="headerlink" href="#release-14-0-4-2024-05-29" title="Link to this heading">#</a></h2>
<section id="fixes">
<h3>Fixes<a class="headerlink" href="#fixes" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/functions/query_parallel_or.html"><span class="doc">query_parallel_or</span></a>] Fixed a bug that the <a class="reference internal" href="../reference/commands/select.html#select-match-escalation-threshold"><span class="std std-ref">match_escalation_threshold</span></a> or <code class="docutils literal notranslate"><span class="pre">force_match_escalation</span></code> options were ignored when using <code class="docutils literal notranslate"><span class="pre">query_parallel_or()</span></code>.</p>
<p>Before the fix, even when <code class="docutils literal notranslate"><span class="pre">match_escalation_threshold</span></code> was set to disable match escalation, the results still escalated when we use <code class="docutils literal notranslate"><span class="pre">query_parallel_or()</span></code>.
This problem occurred only <code class="docutils literal notranslate"><span class="pre">query_parallel_or()</span></code>. <a class="reference internal" href="../reference/functions/query.html"><span class="doc">query</span></a> don’t occur this problem.</p>
<p>Generally, we don’t disable match escalation. Because we want to get something search results. The number of hits is 0 is the unwelcome result of us.
Therefore, this problem has no effect by many users. However, it has effect by user who use stop word as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plugin_register</span> <span class="n">token_filters</span><span class="o">/</span><span class="n">stop_word</span>

<span class="n">table_create</span> <span class="n">Memos</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span> \
  <span class="o">--</span><span class="n">token_filters</span> <span class="n">TokenFilterStopWord</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">memos_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Memos</span> <span class="n">content</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">is_stop_word</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Bool</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Terms</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="s2">&quot;is_stop_word&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello and Good-bye&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Good-bye&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Memos</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;query_parallel_or([&quot;content&quot;, &quot;content&quot;, &quot;content&quot;, &quot;content&quot;], </span><span class="se">\</span>
<span class="s1">            &quot;and&quot;, </span><span class="se">\</span>
<span class="s1">            {&quot;options&quot;: {&quot;TokenFilterStopWord.enable&quot;: true}})&#39;</span> \
  <span class="o">--</span><span class="n">match_escalation_threshold</span> <span class="o">-</span><span class="mi">1</span> \
  <span class="o">--</span><span class="n">sort_keys</span> <span class="o">-</span><span class="n">_score</span>
</pre></div>
</div>
<p>We don’t want to match a keyword that is registered as stopword.
Therefore, we set <code class="docutils literal notranslate"><span class="pre">-1</span></code> to <code class="docutils literal notranslate"><span class="pre">match_escalation_threshold</span></code> in the above example.
We expect that Groonga doesn’t return records in the above example because of escalation disable and search keyword(<code class="docutils literal notranslate"><span class="pre">and</span></code>) is registered as stopword.
However, If this problem occur, Groonga returns match record.
Because if we use <code class="docutils literal notranslate"><span class="pre">query_parallel_or()</span></code>, <code class="docutils literal notranslate"><span class="pre">match_escalation_threshold</span></code> doesn’t work.</p>
</li>
<li><p>Fixed a bug that full-text search againt a reference column of a vector didn’t work.</p>
<p>This problem has occured Groonga v14.0.0 or later.
This problem has effect if we execute full-text search against a reference column of a vector.</p>
<p>We expected that Groonga returns <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">&quot;Linux</span> <span class="pre">MySQL&quot;]</span></code> and <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">&quot;MySQL</span> <span class="pre">Groonga&quot;]</span></code> as below example.
However, before the fix, Groonga always returned 0 hits as below because of we executed full-text search on a reference column of a vector.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">bugs</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">UInt32</span>

<span class="n">table_create</span> <span class="n">tags</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenDelimit</span>
<span class="n">column_create</span> <span class="n">tags</span> <span class="n">name</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">column_create</span> <span class="n">bugs</span> <span class="n">tags</span> <span class="n">COLUMN_VECTOR</span> <span class="n">tags</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">bugs</span>
<span class="p">[</span>
<span class="p">[</span><span class="s2">&quot;_key&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Linux MySQL&quot;</span><span class="p">],</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;MySQL Groonga&quot;</span><span class="p">],</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Mroonga&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">column_create</span> <span class="n">tags</span> <span class="n">bugs_tags_index</span> <span class="n">COLUMN_INDEX</span> <span class="n">bugs</span> <span class="n">tags</span>

<span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">bugs</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;tags @ &quot;MySQL&quot;&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">0.0</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">0</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;_key&quot;</span><span class="p">,</span>
          <span class="s2">&quot;UInt32&quot;</span>
        <span class="p">],</span>
        <span class="p">[</span>
          <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tags&quot;</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="release-14-0-3-2024-05-09">
<span id="release-14-0-3"></span><h2>Release 14.0.3 - 2024-05-09<a class="headerlink" href="#release-14-0-3-2024-05-09" title="Link to this heading">#</a></h2>
<section id="improvements">
<h3>Improvements<a class="headerlink" href="#improvements" title="Link to this heading">#</a></h3>
<ul>
<li><p>We optimized performance as below.</p>
<ul class="simple">
<li><p>We optimized performance of <code class="docutils literal notranslate"><span class="pre">OR</span></code> and <code class="docutils literal notranslate"><span class="pre">AND</span></code> search when the number of hits were many.</p></li>
<li><p>We optimized performance of prefix search(<code class="docutils literal notranslate"><span class="pre">&#64;^</span></code>).</p></li>
<li><p>We optimized performance of <code class="docutils literal notranslate"><span class="pre">AND</span></code> search when the number of records of <code class="docutils literal notranslate"><span class="pre">A</span></code> more than <code class="docutils literal notranslate"><span class="pre">B</span></code> in condition of <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">AND</span> <span class="pre">B</span></code>.</p></li>
<li><p>We optimized performance of search when we used many dynamic columns.</p></li>
</ul>
</li>
<li><p>[<a class="reference internal" href="../reference/tokenizers/token_ngram.html"><span class="doc">TokenNgram</span></a>] Added new option <code class="docutils literal notranslate"><span class="pre">ignore_blank</span></code>.</p>
<p>We can replace <code class="docutils literal notranslate"><span class="pre">TokenBigramIgnoreBlank</span></code> with <code class="docutils literal notranslate"><span class="pre">TokenNgram(&quot;ignore_blank&quot;,</span> <span class="pre">true)</span></code> as below.</p>
<p>Here is example of use <code class="docutils literal notranslate"><span class="pre">TokenBigram</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tokenize</span> <span class="n">TokenBigram</span> <span class="s2">&quot;! ! !&quot;</span> <span class="n">NormalizerAuto</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715155644.64263</span><span class="p">,</span>
    <span class="mf">0.001013517379760742</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;!&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix_search&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;!&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix_search&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;!&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix_search&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Here is example of use <code class="docutils literal notranslate"><span class="pre">TokenBigramIgnoreBlank</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tokenize</span> <span class="n">TokenBigramIgnoreBlank</span> <span class="s2">&quot;! ! !&quot;</span> <span class="n">NormalizerAuto</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715155680.323451</span><span class="p">,</span>
    <span class="mf">0.0009913444519042969</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;!!!&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix_search&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Here is example of use <code class="docutils literal notranslate"><span class="pre">TokenNgram(&quot;ignore_blank&quot;,</span> <span class="pre">true)</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tokenize</span> <span class="s1">&#39;TokenNgram(&quot;ignore_blank&quot;, true)&#39;</span> <span class="s2">&quot;! ! !&quot;</span> <span class="n">NormalizerAuto</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715155762.340685</span><span class="p">,</span>
    <span class="mf">0.001041412353515625</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;!!!&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;force_prefix_search&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>[<a class="reference internal" href="../install/ubuntu.html"><span class="doc">Ubuntu</span></a>] Add support for Ubuntu 24.04 LTS (Noble Numbat).</p></li>
</ul>
</section>
<section id="id1">
<h3>Fixes<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/commands/request_cancel.html"><span class="doc">request_cancel</span></a>] Fix a bug that Groonga may crash when we execute <code class="docutils literal notranslate"><span class="pre">request_cancel</span></code> command while we execute the other query.</p></li>
<li><p>Fixed the unexpected error when using <code class="docutils literal notranslate"><span class="pre">--post_filter</span></code> with <code class="docutils literal notranslate"><span class="pre">--offset</span></code> greater than the post-filtered result</p>
<p>In the same situation, using <code class="docutils literal notranslate"><span class="pre">--filter</span></code> with <code class="docutils literal notranslate"><span class="pre">--offset</span></code> doesn’t raise the error.
This inconsistency in behavior between <code class="docutils literal notranslate"><span class="pre">--filter</span></code> and <code class="docutils literal notranslate"><span class="pre">--post-filter</span></code> has now been resolved.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Users</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="n">Users</span> <span class="n">age</span> <span class="n">COLUMN_SCALAR</span> <span class="n">UInt32</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span>
<span class="p">[</span>
  <span class="p">[</span><span class="s2">&quot;_key&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">&quot;Chris&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">&quot;Diana&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">&quot;Emily&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">select</span> <span class="n">Users</span> \
  <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;age &gt;= 22&#39;</span> \
  <span class="o">--</span><span class="n">post_filter</span> <span class="s1">&#39;age &lt;= 24&#39;</span> \
  <span class="o">--</span><span class="n">offset</span> <span class="mi">3</span> \
  <span class="o">--</span><span class="n">sort_keys</span> <span class="o">-</span><span class="n">age</span> <span class="o">--</span><span class="n">output_pretty</span> <span class="n">yes</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="o">-</span><span class="mi">68</span><span class="p">,</span>
    <span class="mf">1715224057.317582</span><span class="p">,</span>
    <span class="mf">0.001833438873291016</span><span class="p">,</span>
    <span class="s2">&quot;[table][sort] grn_output_range_normalize failed&quot;</span><span class="p">,</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="s2">&quot;grn_table_sort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;/home/horimoto/Work/free-software/groonga.tag/lib/sort.c&quot;</span><span class="p">,</span>
        <span class="mi">1052</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Fixed a bug where incorrect search result could be returned when not all phrases within <code class="docutils literal notranslate"><span class="pre">(...)</span></code> matched using near phrase product.</p>
<p>For example, there is no record which matched <code class="docutils literal notranslate"><span class="pre">(2)</span></code> condition using <code class="docutils literal notranslate"><span class="pre">--query</span> <span class="pre">'*NPP1&quot;(a)</span> <span class="pre">(2)&quot;'</span></code>.
In this case, the expected behavior would be return no record. However, the actual behavior was equal to the query <code class="docutils literal notranslate"><span class="pre">--query</span> <span class="pre">'*NPP</span> <span class="pre">and</span> <span class="pre">&quot;(a)&quot;</span></code> as below.
This means that despite no records matched <code class="docutils literal notranslate"><span class="pre">(2)</span></code>, records like <code class="docutils literal notranslate"><span class="pre">ax1</span></code> and <code class="docutils literal notranslate"><span class="pre">axx1</span></code> were incorrectly returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span>   <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenNgram</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">entries_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">content</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;ax1&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;axx1&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">content</span> \
  <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;*NPP1&quot;(a) (2)&quot;&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;content&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715224211.050228</span><span class="p">,</span>
    <span class="mf">0.001366376876831055</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">2</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;content&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Text&quot;</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;ax1&quot;</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;axx1&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Fixed a bug that rehash failed or data in a table broke when rehash occurred that the table with <code class="docutils literal notranslate"><span class="pre">TABLE_HASH_KEY</span></code> has  2^28 or more records.</p></li>
<li><p>Fixed a bug that highlight position slipped out of place in the following cases.</p>
<ul>
<li><p>If full width space existed before highlight target characters as below.</p>
<p>We expected that Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;Groonga　&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;高&lt;/span&gt;速！&quot;</span></code>.
However, Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;Groonga　&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;高速&lt;/span&gt;！&quot;</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">body</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="s1">&#39;TokenNgram(&quot;report_source_location&quot;, true)&#39;</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="s1">&#39;NormalizerNFKC150(&quot;report_source_offset&quot;, true)&#39;</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">document_index</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">body</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga　高速！&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="n">select</span> <span class="n">Entries</span> \
  <span class="o">--</span><span class="n">output_columns</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">body</span> \
  <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;高&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;highlight_html(body, Terms)&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715215640.979517</span><span class="p">,</span>
    <span class="mf">0.001608610153198242</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;highlight_html&quot;</span><span class="p">,</span>
          <span class="n">null</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;Groonga　&lt;span class=</span><span class="se">\&quot;</span><span class="s2">keyword</span><span class="se">\&quot;</span><span class="s2">&gt;高速&lt;/span&gt;！&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>If we used <code class="docutils literal notranslate"><span class="pre">TokenNgram(&quot;loose_blank&quot;,</span> <span class="pre">true)</span></code> and if highlight target characters included full width space as below.</p>
<p>We expected that Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;山田</span> <span class="pre">太郎&lt;/span&gt;&quot;</span></code>.
However, Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;山田</span> <span class="pre">太&lt;/span&gt;&quot;</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">body</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="s1">&#39;TokenNgram(&quot;loose_blank&quot;, true, &quot;report_source_location&quot;, true)&#39;</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="s1">&#39;NormalizerNFKC150(&quot;report_source_offset&quot;, true)&#39;</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">document_index</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">body</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;山田 太郎&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> <span class="o">--</span><span class="n">output_columns</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">body</span> <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;山田太郎&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;highlight_html(body, Terms)&#39;</span> <span class="o">--</span><span class="n">output_pretty</span> <span class="n">yes</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715220409.096246</span><span class="p">,</span>
    <span class="mf">0.0004854202270507812</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;highlight_html&quot;</span><span class="p">,</span>
          <span class="n">null</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;&lt;span class=</span><span class="se">\&quot;</span><span class="s2">keyword</span><span class="se">\&quot;</span><span class="s2">&gt;山田 太&lt;/span&gt;&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>If white space existed in the front of highlight target characters as below.</p>
<p>We expected that Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;山&lt;/span&gt;田太郎&quot;</span></code>.
However, Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;山&lt;/span&gt;&quot;</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">body</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="s1">&#39;TokenNgram(&quot;report_source_location&quot;, true)&#39;</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="s1">&#39;NormalizerNFKC150(&quot;report_source_offset&quot;, true)&#39;</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">document_index</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">body</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot; 山田太郎&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> \
  <span class="o">--</span><span class="n">output_columns</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">body</span> \
  <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;山&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;highlight_html(body, Terms)&#39;</span> <span class="o">--</span><span class="n">output_pretty</span> <span class="n">yes</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715221627.002193</span><span class="p">,</span>
    <span class="mf">0.001977920532226562</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;highlight_html&quot;</span><span class="p">,</span>
          <span class="n">null</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot; &lt;span class=</span><span class="se">\&quot;</span><span class="s2">keyword</span><span class="se">\&quot;</span><span class="s2">&gt;山&lt;/span&gt;&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>If the second character of highlight target was full width space as below.</p>
<p>We expected that Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;山　田&lt;/span&gt;太郎&quot;</span></code>.
However, Groonga returned <code class="docutils literal notranslate"><span class="pre">&quot;&lt;span</span> <span class="pre">class=\&quot;keyword\&quot;&gt;山　田太&lt;/span&gt;郎&quot;</span></code> as below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">body</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>

<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">default_tokenizer</span> <span class="s1">&#39;TokenNgram(&quot;report_source_location&quot;, true)&#39;</span> \
  <span class="o">--</span><span class="n">normalizer</span> <span class="s1">&#39;NormalizerNFKC150(&quot;report_source_offset&quot;, true)&#39;</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">document_index</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">body</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;山　田太郎&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Entries</span> \
  <span class="o">--</span><span class="n">output_columns</span> \
  <span class="o">--</span><span class="n">match_columns</span> <span class="n">body</span> \
  <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;山　田&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;highlight_html(body, Terms)&#39;</span>
<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1715222501.496007</span><span class="p">,</span>
    <span class="mf">0.0005536079406738281</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">0</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;highlight_html&quot;</span><span class="p">,</span>
          <span class="s2">&quot;&lt;span class=</span><span class="se">\&quot;</span><span class="s2">keyword</span><span class="se">\&quot;</span><span class="s2">&gt;山　田太&lt;/span&gt;郎&quot;</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="release-14-0-2-2024-03-29">
<span id="release-14-0-2"></span><h2>Release 14.0.2 - 2024-03-29<a class="headerlink" href="#release-14-0-2-2024-03-29" title="Link to this heading">#</a></h2>
<section id="id2">
<h3>Improvements<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul>
<li><p>Reduced a log level of a log when Groonga setting normalizers/tokenizer/token_filters against temporary table.</p>
<p>For example, the target log of this modification is the following log.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DDL</span><span class="p">:</span><span class="mi">1234567890</span><span class="p">:</span><span class="n">set_normalizers</span> <span class="n">NormalizerAuto</span>
</pre></div>
</div>
<p>PGroonga sets normalizers against temporary table on start. So, this log becomes noise.
Because this log become output when PGroonga start because of PGroonga’s default log level is <code class="docutils literal notranslate"><span class="pre">notice</span></code>.</p>
<p>Therefore, we reduce log level to <code class="docutils literal notranslate"><span class="pre">debug</span></code> for the log since this release.
Thus, this log does not output when PGroonga start in default.</p>
</li>
</ul>
</section>
</section>
<section id="release-14-0-1-2024-03-14">
<span id="release-14-0-1"></span><h2>Release 14.0.1 - 2024-03-14<a class="headerlink" href="#release-14-0-1-2024-03-14" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Improvements<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul>
<li><p>[<a class="reference internal" href="../reference/commands/load.html"><span class="doc">load</span></a>] Stopped reporting an error when we <code class="docutils literal notranslate"><span class="pre">load</span></code> key that becomes an empty key by normalization.</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> becomes <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> with <code class="docutils literal notranslate"><span class="pre">NormalizerNFKC150(&quot;remove_symbol&quot;,</span> <span class="pre">true)</span></code>. So the following case reports a “empty key” error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Values</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">normalizers</span> <span class="s1">&#39;NormalizerNFKC150(&quot;remove_symbol&quot;, true)&#39;</span>
<span class="n">table_create</span> <span class="n">Data</span> <span class="n">TABLE_NO_KEY</span>
<span class="n">column_create</span> <span class="n">Data</span> <span class="n">value</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Values</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Data</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>However, if we many <code class="docutils literal notranslate"><span class="pre">load</span></code> in such data, many error log are generated.
Because Groonga output many “empty key” error because of Groonga can’t register empty string to index.</p>
<p>No problem even if empty string can’t register to index in such case.
Because we don’t match anything even if we search by empty string. So, we stop reporting an “empty key” error in such case.</p>
</li>
</ul>
</section>
<section id="id4">
<h3>Fixes<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<ul>
<li><p>Fixed a crash bug if a request is canceled <a class="reference internal" href="../reference/functions/between.html"><span class="doc">between</span></a> or range search.</p>
<p>This bug doesn’t necessarily occur. This bug occur when we cancel a request in the specific timing.
This bug occur easily when search time is long such as sequential search.</p>
</li>
<li><p>Fixed a bug that <a class="reference internal" href="../reference/functions/highlight_html.html"><span class="doc">highlight_html</span></a> may return invalid result when the following conditions are met.</p>
<ul class="simple">
<li><p>We use multiple normalizers such as <code class="docutils literal notranslate"><span class="pre">NormalizerTable</span></code> and <code class="docutils literal notranslate"><span class="pre">NormalizerNFKC150</span></code>.</p></li>
<li><p>We highlight string include whitespace.</p></li>
</ul>
<p>For example, this bug occur such as the following case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">NormalizationsIndex</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>

<span class="n">table_create</span> <span class="n">Normalizations</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">UInt64</span>
<span class="n">column_create</span> <span class="n">Normalizations</span> <span class="n">normalized</span> <span class="n">COLUMN_SCALAR</span> <span class="n">LongText</span>
<span class="n">column_create</span> <span class="n">Normalizations</span> <span class="n">target</span> <span class="n">COLUMN_SCALAR</span> <span class="n">NormalizationsIndex</span>

<span class="n">column_create</span> <span class="n">NormalizationsIndex</span> <span class="n">index</span> <span class="n">COLUMN_INDEX</span> <span class="n">Normalizations</span> <span class="n">target</span>


<span class="n">table_create</span> <span class="n">Lexicon</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> \
  <span class="o">--</span><span class="n">normalizers</span> <span class="s1">&#39;NormalizerTable(&quot;normalized&quot;, </span><span class="se">\</span>
<span class="s1">                                 &quot;Normalizations.normalized&quot;, </span><span class="se">\</span>
<span class="s1">                                 &quot;target&quot;, </span><span class="se">\</span>
<span class="s1">                                 &quot;target&quot;), NormalizerNFKC150&#39;</span>

<span class="n">table_create</span> <span class="n">Names</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">UInt64</span>
<span class="n">column_create</span> <span class="n">Names</span> <span class="n">name</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Lexicon</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Names</span>
<span class="p">[</span>
<span class="p">[</span><span class="s2">&quot;_key&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;Sato Toshio&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">select</span> <span class="n">Names</span> \
  <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;_key:1 OR name._key:@&quot;Toshio&quot;&#39;</span> \
  <span class="o">--</span><span class="n">output_columns</span> <span class="s1">&#39;highlight_html(name._key, Lexicon)</span>

<span class="p">[</span>
  <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">1710401574.332274</span><span class="p">,</span>
    <span class="mf">0.001911401748657227</span>
  <span class="p">],</span>
  <span class="p">[</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">1</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;highlight_html&quot;</span><span class="p">,</span>
          <span class="n">null</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="s2">&quot;sato &lt;span class=</span><span class="se">\&quot;</span><span class="s2">keyword</span><span class="se">\&quot;</span><span class="s2">&gt;toshi&lt;/span&gt;o&quot;</span>
      <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>[<a class="reference internal" href="../install/ubuntu.html"><span class="doc">Ubuntu</span></a>] We become able to provide package for Ubuntu again.</p>
<p>We don’t provide packages for Ubuntu in Groonga version 14.0.0.
Because we fail makeing Groonga package for Ubuntu by problrm of build environment for Ubuntu package.</p>
<p>We fixed problrm of build environment for Ubuntu package in 14.0.1. So, we can provide packages for Ubuntu again since this release.</p>
</li>
<li><p>Fixed build error when we build from source by using <a class="reference external" href="https://clang.llvm.org/"><code class="docutils literal notranslate"><span class="pre">clang</span></code></a>. [GitHub#1738][Reported by windymelt]</p></li>
</ul>
</section>
<section id="thanks">
<h3>Thanks<a class="headerlink" href="#thanks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>windymelt</p></li>
</ul>
</section>
</section>
<section id="release-14-0-0-2024-02-29">
<span id="release-14-0-0"></span><h2>Release 14.0.0 - 2024-02-29<a class="headerlink" href="#release-14-0-0-2024-02-29" title="Link to this heading">#</a></h2>
<p>This is a major version up!
But It keeps backward compatibility. We can upgrade to 14.0.0 without rebuilding database.</p>
<section id="id5">
<h3>Improvements<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ul>
<li><p>Added a new tokenizer <code class="docutils literal notranslate"><span class="pre">TokenH3Index</span></code> (experimental).</p>
<p><code class="docutils literal notranslate"><span class="pre">TokenH3Index</span></code>tokenizes WGS84GetPoint to UInt64(H3 index).</p>
</li>
<li><p>Added support for offline and online index construction with non text based tokenizer (experimental).</p>
<p><code class="docutils literal notranslate"><span class="pre">TokenH3Index</span></code> is one of non text based tokenizers.</p>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for searching by index with non text based tokenizer (experimental).</p>
<p><code class="docutils literal notranslate"><span class="pre">TokenH3Index</span></code> is one of non text based tokenizers.</p>
</li>
<li><p>Added new functions <code class="docutils literal notranslate"><span class="pre">distance_cosine()</span></code>, <code class="docutils literal notranslate"><span class="pre">distance_inner_product()</span></code>, <code class="docutils literal notranslate"><span class="pre">distance_l2_norm_squared()</span></code>, <code class="docutils literal notranslate"><span class="pre">distance_l1_norm()</span></code>.</p>
<p>We can only get records that a small distance as vector with these functions and <code class="docutils literal notranslate"><span class="pre">limit</span> <span class="pre">N</span></code></p>
<p>These functions calculate distance in the <code class="docutils literal notranslate"><span class="pre">output</span></code> stage.</p>
<p>However, we don’t optimaize these functions yet.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">distance_cosine()</span></code>: Calculate cosine similarity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distance_inner_product()</span></code>: Calculate inner product.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distance_l2_norm_squared()</span></code>: Calculate euclidean distance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distance_l1_norm()</span></code>: Calculate manhattan distance.</p></li>
</ul>
</li>
<li><p>Added a new function <code class="docutils literal notranslate"><span class="pre">number_round()</span></code>.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/load.html"><span class="doc">load</span></a>] Added support for parallel <code class="docutils literal notranslate"><span class="pre">load</span></code>.</p>
<p>This feature only enable when the <code class="docutils literal notranslate"><span class="pre">input_type</span></code> of <code class="docutils literal notranslate"><span class="pre">load</span></code> is <code class="docutils literal notranslate"><span class="pre">apache-arrow</span></code>.</p>
<p>This feature one thread per column. If there are many target columns, it will reduce load time.</p>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] We can use uvector as much as possible for array literal in <code class="docutils literal notranslate"><span class="pre">--filter</span></code>.</p>
<p>uvector is vector of elements with fix size.</p>
<p>If all elements have the same type, we use uvector instead vector.</p>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/status.html"><span class="doc">status</span></a>] Added <code class="docutils literal notranslate"><span class="pre">n_workers</span></code> to output of <code class="docutils literal notranslate"><span class="pre">status</span></code>.</p></li>
<li><p>Optimized a dynamic column creation.</p></li>
<li><p>[WAL] Added support for rebuilding broken indexes in parallel.</p></li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Added support for <code class="docutils literal notranslate"><span class="pre">Int64</span></code> in <code class="docutils literal notranslate"><span class="pre">output_type=apache-arrow</span></code> for columns that reference other table.</p></li>
</ul>
</section>
<section id="id6">
<h3>Fixes<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<ul>
<li><p>[Windows] Fixed path for documents of <code class="docutils literal notranslate"><span class="pre">groonga-normalizer-mysql</span></code> in package for Windows.</p>
<p>Documents of <code class="docutils literal notranslate"><span class="pre">groonga-normalizer-mysql</span></code> put under the <code class="docutils literal notranslate"><span class="pre">share/</span></code> in this release.</p>
</li>
<li><p>[<a class="reference internal" href="../reference/commands/select.html"><span class="doc">select</span></a>] Fixed a bug that Groonga may crash when we use bitwise operations.</p></li>
</ul>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-14-0-4-2024-05-29">Release 14.0.4 - 2024-05-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixes">Fixes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-14-0-3-2024-05-09">Release 14.0.3 - 2024-05-09</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#improvements">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Fixes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-14-0-2-2024-03-29">Release 14.0.2 - 2024-03-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Improvements</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-14-0-1-2024-03-14">Release 14.0.1 - 2024-03-14</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Fixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thanks">Thanks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#release-14-0-0-2024-02-29">Release 14.0.0 - 2024-02-29</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Improvements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Fixes</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/groonga/groonga/edit/main/doc/source/news/14.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2009-2024 Groonga Project.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>